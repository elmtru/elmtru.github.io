var Bs=Object.defineProperty;var Hs=(n,t,l)=>t in n?Bs(n,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):n[t]=l;var Ue=(n,t,l)=>(Hs(n,typeof t!="symbol"?t+"":t,l),l);import{aj as Ft,w as an,ak as Ks,$ as Ys,s as st,e as P,b as M,d as q,g as b,h,i as O,al as Ln,o as Qe,v as Ps,c as Fe,u as Ze,k as We,m as Ge,J as $e,am as on,an as rl,p as Xe,a as D,n as _e,f as V,X as Ct,q as rn,I as Nn,j as y,r as qt,K as zn,t as Vt,M as Qt,W as Ms,Q as He,N as oe,O as ae,P as St,l as X,G as sl,L as Is,Y as x,a1 as Mn,V as _t,ao as Sn,ap as ve,S as Cn,T as hn,aq as Xt,ai as Fs}from"./scheduler.DSZzDcX6.js";import{S as Ot,i as Pt,t as p,g as we,a as S,c as Se,b as $,d as ee,m as te,e as ne,f as An}from"./index.Ck97c3H1.js";import{e as lt}from"./each.CNH9y-bx.js";import{g as Jt,a as cn}from"./spread.CgU5AtxT.js";import{P as Zs,S as Ws,R as Gs,C as gl,q as Ls,W as Xs,r as qs,L as bl,t as Qs,A as Js,u as pn,T as Ce,v as Ns,G as xs,w as zs,x as kt,y as $s,z as Dt,B as ei,D as ti,E as ni,F as li,H as si,I as ii,J as pl,K as oi,M as ai,N as ri,O as ci,V as Be,Q as tn,U as nn,X as Rn,Y as vl,Z as wt,_ as fi,$ as yl,a0 as In,a1 as ui,a2 as mi,a3 as _i,a4 as gn,a5 as il,a6 as di,a7 as ln,f as kl,a8 as hi,c as El,a9 as jn,p as ol,aa as As,ab as al,b as Tl,ac as wl,ad as Sl}from"./index.CdZlA5Fd.js";import{d as Cl}from"./api.Dpw5L1iu.js";import{d as jt,w as nt,r as gi}from"./index.PMJqI94-.js";import"./Tooltip.svelte_svelte_type_style_lang.BzaACov9.js";import"./entry.BzDjQvFf.js";import{g as bi}from"./globals.D0QH3NT1.js";function pi(n){return{all:n=n||new Map,on:function(t,l){var e=n.get(t);e?e.push(l):n.set(t,[l])},off:function(t,l){var e=n.get(t);e&&(l?e.splice(e.indexOf(l)>>>0,1):n.set(t,[]))},emit:function(t,l){var e=n.get(t);e&&e.slice().map(function(s){s(l)}),(e=n.get("*"))&&e.slice().map(function(s){s(t,l)})}}}class Gt{constructor(){Ue(this,"allVertices",{});Ue(this,"isolatedVertices",{});Ue(this,"connectedVertices",{});Ue(this,"sortedConnectedValues",[]);Ue(this,"needsSort",!1);Ue(this,"emitter",pi());Ue(this,"emit",this.emitter.emit.bind(this.emitter));Ue(this,"on",this.emitter.on.bind(this.emitter));Ue(this,"off",this.emitter.off.bind(this.emitter));Ue(this,"getKey",t=>typeof t=="object"?t.key:t)}get sortedVertices(){return this.mapNodes(t=>t)}moveToIsolated(t){const l=this.connectedVertices[t];l&&(this.isolatedVertices[t]=l,delete this.connectedVertices[t])}moveToConnected(t){const l=this.isolatedVertices[t];l&&(this.connectedVertices[t]=l,delete this.isolatedVertices[t])}add(t,l,e){if(this.allVertices[t]&&this.allVertices[t].value!==void 0)throw new Error(`A node with the key ${t.toString()} already exists`);let s=this.allVertices[t];s?s.value===void 0&&(s.value=l):(s={value:l,previous:new Set,next:new Set},this.allVertices[t]=s);const i=s.next.size>0||s.previous.size>0;if(!(e!=null&&e.after)&&!(e!=null&&e.before)&&!i){this.isolatedVertices[t]=s,this.emit("node:added",{key:t,type:"isolated",value:l});return}else this.connectedVertices[t]=s;if(e!=null&&e.after){const r=Array.isArray(e.after)?e.after:[e.after];r.forEach(o=>{s.previous.add(this.getKey(o))}),r.forEach(o=>{const a=this.getKey(o),f=this.allVertices[a];f?(f.next.add(t),this.moveToConnected(a)):(this.allVertices[a]={value:void 0,previous:new Set,next:new Set([t])},this.connectedVertices[a]=this.allVertices[a])})}if(e!=null&&e.before){const r=Array.isArray(e.before)?e.before:[e.before];r.forEach(o=>{s.next.add(this.getKey(o))}),r.forEach(o=>{const a=this.getKey(o),f=this.allVertices[a];f?(f.previous.add(t),this.moveToConnected(a)):(this.allVertices[a]={value:void 0,previous:new Set([t]),next:new Set},this.connectedVertices[a]=this.allVertices[a])})}this.emit("node:added",{key:t,type:"connected",value:l}),this.needsSort=!0}remove(t){const l=this.getKey(t);if(this.isolatedVertices[l]){delete this.isolatedVertices[l],delete this.allVertices[l],this.emit("node:removed",{key:l,type:"isolated"});return}const s=this.connectedVertices[l];s&&(s.next.forEach(i=>{const r=this.connectedVertices[i];r&&(r.previous.delete(l),r.previous.size===0&&r.next.size===0&&this.moveToIsolated(i))}),s.previous.forEach(i=>{const r=this.connectedVertices[i];r&&(r.next.delete(l),r.previous.size===0&&r.next.size===0&&this.moveToIsolated(i))}),delete this.connectedVertices[l],delete this.allVertices[l],this.emit("node:removed",{key:l,type:"connected"}),this.needsSort=!0)}mapNodes(t){this.needsSort&&this.sort();const l=[];return this.forEachNode((e,s)=>{l.push(t(e,s))}),l}forEachNode(t){this.needsSort&&this.sort();let l=0;for(;l<this.sortedConnectedValues.length;l++)t(this.sortedConnectedValues[l],l);Reflect.ownKeys(this.isolatedVertices).forEach(e=>{const s=this.isolatedVertices[e];s.value!==void 0&&t(s.value,l++)})}getValueByKey(t){var l;return(l=this.allVertices[t])==null?void 0:l.value}getKeyByValue(t){return Reflect.ownKeys(this.connectedVertices).find(l=>this.connectedVertices[l].value===t)??Reflect.ownKeys(this.isolatedVertices).find(l=>this.isolatedVertices[l].value===t)}sort(){var r;const t=new Map,l=[],e=[],s=Reflect.ownKeys(this.connectedVertices).filter(o=>this.connectedVertices[o].value!==void 0);for(s.forEach(o=>{t.set(o,0)}),s.forEach(o=>{this.connectedVertices[o].next.forEach(f=>{this.connectedVertices[f]&&t.set(f,(t.get(f)||0)+1)})}),t.forEach((o,a)=>{o===0&&l.push(a)});l.length>0;){const o=l.shift();e.push(o);const a=s.find(f=>f===o);a&&((r=this.connectedVertices[a])==null||r.next.forEach(f=>{const c=(t.get(f)||0)-1;t.set(f,c),c===0&&l.push(f)}))}if(e.length!==s.length)throw new Error("The graph contains a cycle, and thus can not be sorted topologically.");const i=o=>o!==void 0;this.sortedConnectedValues=e.map(o=>this.connectedVertices[o].value).filter(i),this.needsSort=!1}clear(){this.allVertices={},this.isolatedVertices={},this.connectedVertices={},this.sortedConnectedValues=[],this.needsSort=!1}static isKey(t){return typeof t=="string"||typeof t=="symbol"}static isValue(t){return typeof t=="object"&&"key"in t}}class vi{constructor(t,l,e){Ue(this,"key");Ue(this,"stage");Ue(this,"callback");Ue(this,"runTask",!0);this.stage=t,this.key=l,this.callback=e}stop(){this.runTask=!1}start(){this.runTask=!0}run(t){this.runTask&&this.callback(t)}}class yi extends Gt{constructor(l,e,s){super();Ue(this,"key");Ue(this,"scheduler");Ue(this,"callback",(l,e)=>e());Ue(this,"removeTask",this.remove.bind(this));this.scheduler=l,this.key=e,s&&(this.callback=s.bind(this))}get tasks(){return this.sortedVertices}createTask(l,e,s){const i=new vi(this,l,e);return this.add(l,i,s),i}getTask(l){return this.getValueByKey(l)}run(l){this.callback(l,e=>{this.forEachNode(s=>{s.run(e??l)})})}runWithTiming(l){const e={};return this.callback(l,s=>{this.forEachNode(i=>{const r=performance.now();i.run(s??l);const o=performance.now()-r;e[i.key]=o})}),e}getSchedule(){return this.mapNodes(l=>l.key.toString())}}class ki extends Gt{constructor(l){super();Ue(this,"lastTime",performance.now());Ue(this,"clampDeltaTo",.1);Ue(this,"removeStage",this.remove.bind(this));l!=null&&l.clampDeltaTo&&(this.clampDeltaTo=l.clampDeltaTo),this.run=this.run.bind(this)}get stages(){return this.sortedVertices}createStage(l,e){const s=new yi(this,l,e==null?void 0:e.callback);return this.add(l,s,{after:e==null?void 0:e.after,before:e==null?void 0:e.before}),s}getStage(l){return this.getValueByKey(l)}run(l){const e=l-this.lastTime;this.forEachNode(s=>{s.run(Math.min(e/1e3,this.clampDeltaTo))}),this.lastTime=l}runWithTiming(l){const e=l-this.lastTime,s={},i=performance.now();return this.forEachNode(r=>{const o=performance.now(),a=r.runWithTiming(Math.min(e/1e3,this.clampDeltaTo)),f=performance.now()-o;s[r.key.toString()]={duration:f,tasks:a}}),{total:performance.now()-i,stages:s}}getSchedule(l={tasks:!0}){return{stages:this.mapNodes(e=>{if(e===void 0)throw new Error("Stage not found");return{key:e.key.toString(),tasks:l.tasks?e.getSchedule():void 0}})}}dispose(){this.clear()}}const Ei=Symbol("use-legacy-frame-compatibility-context"),Ti=()=>{const n={useFrameOrders:[],useRenderOrders:[]};return Ft(Ei,n),n},pt=(n,t)=>{const l=jt(n,i=>i);let e;const s=l.subscribe(async i=>{e&&e();const r=await t(i);r&&(e=r)});an(()=>{s(),e&&e()})};function Rs(n,t){const l={current:void 0};return pt(n,e=>{l.current=t?t(e):e}),l}const xe=n=>{const t=nt(n),l={set:e=>{l.current=e,t.set(e)},subscribe:t.subscribe,update:e=>{const s=e(l.current);l.current=s,t.set(s)},current:n};return l},cl=typeof window<"u",wi=()=>{const n=xe({width:0,height:0});if(!cl)return{parentSize:n,parentSizeAction:()=>{}};const t={childList:!0,subtree:!1,attributes:!1};let l;const e=o=>{s.disconnect(),i.disconnect(),s.observe(o),i.observe(o,t)},s=new ResizeObserver(([o])=>{const{width:a,height:f}=o.contentRect;a===n.current.width&&f===n.current.height||n.set({width:a,height:f})}),i=new MutationObserver(o=>{for(const a of o)for(const f of a.removedNodes)if(l===f&&l.parentElement){e(l.parentElement);return}}),r=o=>{l=o;const a=l.parentElement;a&&(n.set({width:a.clientWidth,height:a.clientHeight}),e(a))};return an(()=>{s.disconnect(),i.disconnect()}),{parentSize:n,parentSizeAction:r}},Si=()=>{Ft("threlte-cache",[])},js=n=>n.userData,Ci=()=>{const n=new Zs(75,0,.1,1e3);return js(n).threlteDefaultCamera=!0,n.position.z=5,n.lookAt(0,0,0),n},Oi=n=>{pt(n.size,t=>{js(Ks(n.camera)).threlteDefaultCamera&&n.camera.update(l=>{const e=l;return e.aspect=t.width/t.height,e.updateProjectionMatrix(),n.invalidate(),e})})},Pi=n=>{const t={frameInvalidated:!0,advance:!1,autoInvalidations:new Set,resetFrameInvalidation:()=>{t.frameInvalidated=!1,t.advance=!1},dispose:async(r=!1)=>{await Ys(),!(!t.shouldDispose&&!r)&&(t.disposableObjects.forEach((o,a)=>{var f;(o===0||r)&&((f=a==null?void 0:a.dispose)==null||f.call(a),t.disposableObjects.delete(a))}),t.shouldDispose=!1)},collectDisposableObjects:(r,o)=>{const a=o??[];return r&&(r!=null&&r.dispose&&typeof r.dispose=="function"&&r.type!=="Scene"&&a.push(r),Object.entries(r).forEach(([f,c])=>{if(f==="parent"||f==="children"||typeof c!="object")return;const u=c;u!=null&&u.dispose&&t.collectDisposableObjects(u,a)})),a},addDisposableObjects:r=>{r.forEach(o=>{const a=t.disposableObjects.get(o);a?t.disposableObjects.set(o,a+1):t.disposableObjects.set(o,1)})},removeDisposableObjects:r=>{r.length!==0&&(r.forEach(o=>{const a=t.disposableObjects.get(o);a&&a>0&&t.disposableObjects.set(o,a-1)}),t.shouldDispose=!0)},disposableObjects:new Map,shouldDispose:!1},l={size:jt([n.userSize,n.parentSize],([r,o])=>r||o),camera:xe(Ci()),scene:new Ws,renderer:void 0,invalidate:()=>{t.frameInvalidated=!0},advance:()=>{t.advance=!0},colorSpace:xe(n.colorSpace),toneMapping:xe(n.toneMapping),dpr:xe(n.dpr),useLegacyLights:xe(n.useLegacyLights),shadows:xe(n.shadows),colorManagementEnabled:xe(n.colorManagementEnabled),renderMode:xe(n.renderMode),autoRender:xe(n.autoRender),scheduler:void 0,mainStage:void 0,renderStage:void 0,autoRenderTask:void 0,shouldRender:()=>l.renderMode.current==="always"||l.renderMode.current==="on-demand"&&(t.frameInvalidated||t.autoInvalidations.size>0)||l.renderMode.current==="manual"&&t.advance},e=xe({});return Ft("threlte",l),Ft("threlte-internal-context",t),Ft("threlte-user-context",e),{ctx:l,internalCtx:t,getCtx:()=>l,getInternalCtx:()=>t}},Mi=Gs.replace("dev",""),sn=Number.parseInt(Mi),Ii={srgb:qs,"srgb-linear":bl,"":bl},Li=n=>n.outputColorSpace!==void 0,Ni=n=>{const t=nt(void 0),l=(e,s)=>{n.renderer=new Xs({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...s}),t.set(n.renderer)};return pt([n.colorManagementEnabled],([e])=>{sn>=150?gl.enabled=e:gl.legacyMode=!e}),pt([t,n.colorSpace],([e,s])=>{if(e)if(Li(e))e.outputColorSpace=s;else{const i=Ii[s];i?e.outputEncoding=i:console.warn("No encoding found for colorSpace",s)}}),pt([t,n.dpr],([e,s])=>{e==null||e.setPixelRatio(s)}),pt([t,n.size],([e,s])=>{var i;(i=e==null?void 0:e.xr)!=null&&i.isPresenting||e==null||e.setSize(s.width,s.height)}),pt([t,n.shadows],([e,s])=>{e&&(e.shadowMap.enabled=!!s,s&&s!==!0?e.shadowMap.type=s:s===!0&&(e.shadowMap.type=Ls))}),pt([t,n.toneMapping],([e,s])=>{e&&(e.toneMapping=s)}),pt([t,n.useLegacyLights],([e,s])=>{e&&(sn>=150&&s?e.useLegacyLights=s:sn<150&&(e.physicallyCorrectLights=!s))}),{createRenderer:l}};function Ol(n){let t,l;return t=new Qs({props:{object:n[4].ctx.scene,$$slots:{default:[zi]},$$scope:{ctx:n}}}),{c(){$(t.$$.fragment)},l(e){ee(t.$$.fragment,e)},m(e,s){te(t,e,s),l=!0},p(e,s){const i={};s&262144&&(i.$$scope={dirty:s,ctx:e}),t.$set(i)},i(e){l||(p(t.$$.fragment,e),l=!0)},o(e){S(t.$$.fragment,e),l=!1},d(e){ne(t,e)}}}function zi(n){let t;const l=n[16].default,e=Fe(l,n,n[18],null);return{c(){e&&e.c()},l(s){e&&e.l(s)},m(s,i){e&&e.m(s,i),t=!0},p(s,i){e&&e.p&&(!t||i&262144)&&Ze(e,l,s,s[18],t?Ge(l,s[18],i,null):We(s[18]),null)},i(s){t||(p(e,s),t=!0)},o(s){S(e,s),t=!1},d(s){e&&e.d(s)}}}function Ai(n){let t,l,e,s,i=n[1]&&Ol(n);return{c(){t=P("canvas"),i&&i.c(),this.h()},l(r){t=M(r,"CANVAS",{class:!0});var o=q(t);i&&i.l(o),o.forEach(b),this.h()},h(){h(t,"class","svelte-o3oskp")},m(r,o){O(r,t,o),i&&i.m(t,null),n[17](t),l=!0,e||(s=Ln(n[3].call(null,t)),e=!0)},p(r,[o]){r[1]?i?(i.p(r,o),o&2&&p(i,1)):(i=Ol(r),i.c(),p(i,1),i.m(t,null)):i&&(we(),S(i,1,1,()=>{i=null}),Se())},i(r){l||(p(i),l=!0)},o(r){S(i),l=!1},d(r){r&&b(t),i&&i.d(),n[17](null),e=!1,s()}}}function Ri(n,t,l){let e,{$$slots:s={},$$scope:i}=t,{colorManagementEnabled:r=!0}=t,{colorSpace:o="srgb"}=t,{dpr:a=cl?window.devicePixelRatio:1}=t,{renderMode:f="on-demand"}=t,{rendererParameters:c=void 0}=t,{shadows:u=Ls}=t,{size:m=void 0}=t,{toneMapping:_=Js}=t,{useLegacyLights:g=!(sn>=155)}=t,{autoRender:T=!0}=t,k,w=nt(!1);Qe(n,w,N=>l(1,e=N));const j=nt(m),{parentSize:z,parentSizeAction:B}=wi(),{useRenderOrders:I}=Ti(),H=Pi({colorManagementEnabled:r,colorSpace:o,dpr:a,renderMode:f,parentSize:z,autoRender:T,shadows:u,toneMapping:_,useLegacyLights:g,userSize:j}),Y=new ki;H.getCtx().mainStage=Y.createStage(Symbol("threlte-main-stage")),H.getCtx().renderStage=Y.createStage(Symbol("threlte-render-stage"),{after:H.ctx.mainStage,callback(N,re){H.ctx.shouldRender()&&re()}}),H.getCtx().autoRenderTask=H.ctx.renderStage.createTask(Symbol("threlte-auto-render-task"),N=>{I.length>0||H.ctx.renderer.render(v.scene,v.camera.current)}),pt([w,H.ctx.autoRender],([N,re])=>(N&&re?H.getCtx().autoRenderTask.start():H.getCtx().autoRenderTask.stop(),()=>{H.getCtx().autoRenderTask.stop()})),H.getCtx().scheduler=Y,Si();const v=H.ctx;Oi(v);const{createRenderer:L}=Ni(v);Ps(()=>{L(k,c),H.getCtx().renderer.setAnimationLoop(N=>{H.getInternalCtx().dispose(),Y.run(N),H.getInternalCtx().resetFrameInvalidation()}),w.set(!0)}),an(()=>{var N;H.internalCtx.dispose(!0),H.ctx.scheduler.dispose(),(N=H.ctx.renderer)==null||N.dispose()});function Q(N){$e[N?"unshift":"push"](()=>{k=N,l(0,k)})}return n.$$set=N=>{"colorManagementEnabled"in N&&l(5,r=N.colorManagementEnabled),"colorSpace"in N&&l(6,o=N.colorSpace),"dpr"in N&&l(7,a=N.dpr),"renderMode"in N&&l(8,f=N.renderMode),"rendererParameters"in N&&l(9,c=N.rendererParameters),"shadows"in N&&l(10,u=N.shadows),"size"in N&&l(11,m=N.size),"toneMapping"in N&&l(12,_=N.toneMapping),"useLegacyLights"in N&&l(13,g=N.useLegacyLights),"autoRender"in N&&l(14,T=N.autoRender),"$$scope"in N&&l(18,i=N.$$scope)},n.$$.update=()=>{n.$$.dirty&2048&&j.set(m),n.$$.dirty&64&&H.ctx.colorSpace.set(o),n.$$.dirty&128&&H.ctx.dpr.set(a),n.$$.dirty&256&&H.ctx.renderMode.set(f),n.$$.dirty&16384&&H.ctx.autoRender.set(T),n.$$.dirty&1024&&H.ctx.shadows.set(u),n.$$.dirty&4096&&H.ctx.toneMapping.set(_)},[k,e,w,B,H,r,o,a,f,c,u,m,_,g,T,v,s,Q,i]}class ji extends Ot{constructor(t){super(),Pt(this,t,Ri,Ai,st,{colorManagementEnabled:5,colorSpace:6,dpr:7,renderMode:8,rendererParameters:9,shadows:10,size:11,toneMapping:12,useLegacyLights:13,autoRender:14,ctx:15})}get ctx(){return this.$$.ctx[15]}}function Di(n,t){const l="threlte-plugin-context";if(Array.isArray(n)){const[e,s]=n;Ft(l,{...on(l),[e]:s})}else{const e=n,s=t;if(!s)return;Ft(l,{...on(l),[e]:s})}}function fl(n,t,l){if(!cl)return{task:void 0,start:()=>{},stop:()=>{},started:gi(!1)};let e,s,i;Gt.isKey(n)?(e=n,s=t,i=l):(e=Symbol("useTask"),s=n,i=t);const r=pn();let o=r.mainStage;if(i){if(i.stage)if(Gt.isValue(i.stage))o=i.stage;else{const _=r.scheduler.getStage(i.stage);if(!_)throw new Error(`No stage found with key ${i.stage.toString()}`);o=_}else if(i.after)if(Array.isArray(i.after))for(let _=0;_<i.after.length;_++){const g=i.after[_];if(Gt.isValue(g)){o=g.stage;break}}else Gt.isValue(i.after)&&(o=i.after.stage);else if(i.before)if(Array.isArray(i.before))for(let _=0;_<i.before.length;_++){const g=i.before[_];if(Gt.isValue(g)){o=g.stage;break}}else Gt.isValue(i.before)&&(o=i.before.stage)}const{autoInvalidations:a}=on("threlte-internal-context"),f=nt(!1),c=o.createTask(e,s,i),u=()=>{f.set(!0),((i==null?void 0:i.autoInvalidate)??!0)&&a.add(s),c.start()},m=()=>{f.set(!0),((i==null?void 0:i.autoInvalidate)??!0)&&a.delete(s),c.stop()};return(i==null?void 0:i.autoStart)??!0?u():m(),an(()=>{o&&o.removeTask(e)}),{task:c,start:u,stop:m,started:{subscribe:f.subscribe}}}function Vi(n,t,l){const e=on("threlte-user-context");if(!e)throw new Error("No user context store found, did you invoke this function outside of your main <Canvas> component?");return n?n&&!t?jt(e,s=>s[n]):(e.update(s=>{if(n in s){if(!l||l.existing==="skip")return s;if(l.existing==="merge")return Object.assign(s[n],t),s}return s[n]=t,s}),e.current[n]):{subscribe:e.subscribe}}const Dn=()=>{const n=rl(),t=nt(void 0);return pt(t,l=>{l&&Object.entries(n.$$.callbacks).forEach(e=>{const[s,i]=e;s in l.$$.callbacks&&Array.isArray(l.$$.callbacks[s])?l.$$.callbacks[s].push(...i):l.$$.callbacks[s]=i})}),t},Ui=()=>{const n=rl();return{hasEventListeners:l=>{const e=n.$$.callbacks;return l in e&&e[l].length>0}}},Bi=n=>({ref:n[0]&4}),Pl=n=>({ref:n[2]});function Hi(n){let t;const l=n[40].threlte,e=Fe(l,n,n[46],Pl);return{c(){e&&e.c()},l(s){e&&e.l(s)},m(s,i){e&&e.m(s,i),t=!0},p(s,i){e&&e.p&&(!t||i[0]&4|i[1]&32768)&&Ze(e,l,s,s[46],t?Ge(l,s[46],i,Bi):We(s[46]),Pl)},i(s){t||(p(e,s),t=!0)},o(s){S(e,s),t=!1},d(s){e&&e.d(s)}}}function Ki(n){let t=n[1],l,e,s=n[1]&&Qn(n);return{c(){s&&s.c(),l=_e()},l(i){s&&s.l(i),l=_e()},m(i,r){s&&s.m(i,r),O(i,l,r),e=!0},p(i,r){i[1]?t?st(t,i[1])?(s.d(1),s=Qn(i),t=i[1],s.c(),s.m(l.parentNode,l)):s.p(i,r):(s=Qn(i),t=i[1],s.c(),s.m(l.parentNode,l)):t&&(s.d(1),s=null,t=i[1])},i(i){e||(p(s,i),e=!0)},o(i){S(s,i),e=!1},d(i){i&&b(l),s&&s.d(i)}}}function Yi(n){let t=n[1],l,e,s=n[1]&&Jn(n);return{c(){s&&s.c(),l=_e()},l(i){s&&s.l(i),l=_e()},m(i,r){s&&s.m(i,r),O(i,l,r),e=!0},p(i,r){i[1]?t?st(t,i[1])?(s.d(1),s=Jn(i),t=i[1],s.c(),s.m(l.parentNode,l)):s.p(i,r):(s=Jn(i),t=i[1],s.c(),s.m(l.parentNode,l)):t&&(s.d(1),s=null,t=i[1])},i(i){e||(p(s,i),e=!0)},o(i){S(s,i),e=!1},d(i){i&&b(l),s&&s.d(i)}}}function Ml(n){let t;const l=n[40].default,e=Fe(l,n,n[46],null);return{c(){e&&e.c()},l(s){e&&e.l(s)},m(s,i){e&&e.m(s,i),t=!0},p(s,i){e&&e.p&&(!t||i[1]&32768)&&Ze(e,l,s,s[46],t?Ge(l,s[46],i,null):We(s[46]),null)},i(s){t||(p(e,s),t=!0)},o(s){S(e,s),t=!1},d(s){e&&e.d(s)}}}function Qn(n){let t,l,e,s,i,r,o,a=n[6]&&Ml(n),f=[{style:s=Dt(n[11])}],c={};for(let u=0;u<f.length;u+=1)c=Xe(c,f[u]);return{c(){t=P(n[1]),l=P("div"),a&&a.c(),this.h()},l(u){t=M(u,(n[1]||"null").toUpperCase(),{style:!0});var m=q(t);l=M(m,"DIV",{style:!0});var _=q(l);a&&a.l(_),_.forEach(b),m.forEach(b),this.h()},h(){h(l,"style",e=Dt(n[12])),Nn(n[1])(t,c)},m(u,m){O(u,t,m),y(t,l),a&&a.m(l,null),n[45](t),i=!0,r||(o=[Ln(n[23].call(null,t)),Ln(n[22].call(null,t))],r=!0)},p(u,m){u[6]?a?(a.p(u,m),m[0]&64&&p(a,1)):(a=Ml(u),a.c(),p(a,1),a.m(l,null)):a&&(we(),S(a,1,1,()=>{a=null}),Se()),(!i||m[0]&4096&&e!==(e=Dt(u[12])))&&h(l,"style",e),Nn(u[1])(t,c=Jt(f,[(!i||m[0]&2048&&s!==(s=Dt(u[11])))&&{style:s}]))},i(u){i||(p(a),i=!0)},o(u){S(a),i=!1},d(u){u&&b(t),a&&a.d(),n[45](null),r=!1,qt(o)}}}function Il(n){let t;const l=n[40].default,e=Fe(l,n,n[46],null);return{c(){e&&e.c()},l(s){e&&e.l(s)},m(s,i){e&&e.m(s,i),t=!0},p(s,i){e&&e.p&&(!t||i[1]&32768)&&Ze(e,l,s,s[46],t?Ge(l,s[46],i,null):We(s[46]),null)},i(s){t||(p(e,s),t=!0)},o(s){S(e,s),t=!1},d(s){e&&e.d(s)}}}function Jn(n){let t,l,e,s,i,r,o,a,f,c=n[6]&&Il(n),u=[{style:r=Dt(n[8])}],m={};for(let _=0;_<u.length;_+=1)m=Xe(m,u[_]);return{c(){t=P(n[1]),l=P("div"),e=P("div"),c&&c.c(),this.h()},l(_){t=M(_,(n[1]||"null").toUpperCase(),{style:!0});var g=q(t);l=M(g,"DIV",{style:!0});var T=q(l);e=M(T,"DIV",{style:!0});var k=q(e);c&&c.l(k),k.forEach(b),T.forEach(b),g.forEach(b),this.h()},h(){h(e,"style",s=Dt(n[10])),h(l,"style",i=Dt(n[9])),Nn(n[1])(t,m)},m(_,g){O(_,t,g),y(t,l),y(l,e),c&&c.m(e,null),n[42](e),n[43](l),n[44](t),o=!0,a||(f=Ln(n[23].call(null,t)),a=!0)},p(_,g){_[6]?c?(c.p(_,g),g[0]&64&&p(c,1)):(c=Il(_),c.c(),p(c,1),c.m(e,null)):c&&(we(),S(c,1,1,()=>{c=null}),Se()),(!o||g[0]&1024&&s!==(s=Dt(_[10])))&&h(e,"style",s),(!o||g[0]&512&&i!==(i=Dt(_[9])))&&h(l,"style",i),Nn(_[1])(t,m=Jt(u,[(!o||g[0]&256&&r!==(r=Dt(_[8])))&&{style:r}]))},i(_){o||(p(c),o=!0)},o(_){S(c),o=!1},d(_){_&&b(t),c&&c.d(),n[42](null),n[43](null),n[44](null),a=!1,f()}}}function Fi(n){let t,l,e,s,i,r;const o=[{is:n[2]},n[25]];let a={$$slots:{default:[Hi,({ref:m})=>({2:m}),({ref:m})=>[m?4:0]]},$$scope:{ctx:n}};for(let m=0;m<o.length;m+=1)a=Xe(a,o[m]);t=new Ce({props:a}),n[41](t);const f=[Yi,Ki],c=[];function u(m,_){return m[0]?0:1}return e=u(n),s=c[e]=f[e](n),{c(){$(t.$$.fragment),l=D(),s.c(),i=_e()},l(m){ee(t.$$.fragment,m),l=V(m),s.l(m),i=_e()},m(m,_){te(t,m,_),O(m,l,_),c[e].m(m,_),O(m,i,_),r=!0},p(m,_){const g=_[0]&33554436?Jt(o,[_[0]&4&&{is:m[2]},_[0]&33554432&&cn(m[25])]):{};_[0]&4|_[1]&32768&&(g.$$scope={dirty:_,ctx:m}),t.$set(g);let T=e;e=u(m),e===T?c[e].p(m,_):(we(),S(c[T],1,1,()=>{c[T]=null}),Se(),s=c[e],s?s.p(m,_):(s=c[e]=f[e](m),s.c()),p(s,1),s.m(i.parentNode,i))},i(m){r||(p(t.$$.fragment,m),p(s),r=!0)},o(m){S(t.$$.fragment,m),S(s),r=!1},d(m){m&&(b(l),b(i)),n[41](null),ne(t,m),c[e].d(m)}}}function Zi(n,t,l){const e=["transform","calculatePosition","eps","occlude","zIndexRange","sprite","pointerEvents","center","fullscreen","distanceFactor","as","portal","ref","visible"];let s=Ct(t,e),i,r,o,a,f,c,u,m,_,g,{$$slots:T={},$$scope:k}=t,{transform:w=!1}=t,{calculatePosition:j=$s}=t,{eps:z=.001}=t,{occlude:B=!1}=t,{zIndexRange:I=[16777271,0]}=t,{sprite:H=!1}=t,{pointerEvents:Y="auto"}=t,{center:v=!1}=t,{fullscreen:L=!1}=t,{distanceFactor:Q=void 0}=t,{as:N="div"}=t,{portal:re=void 0}=t;const se=Ns();let{ref:U=new xs}=t;const{renderer:Z,camera:ie,scene:be,size:ce}=pn();Qe(n,ie,C=>l(50,r=C)),Qe(n,ce,C=>l(37,i=C));const fe=C=>C.isPerspectiveCamera||C.isOrthographicCamera,Le=()=>{if(!fe(r))throw new Error("Only PerspectiveCamera or OrthographicCamera supported for component <HTML>");return r},de=new zs;let Pe=[0,0],ue=0,{visible:ge=!0}=t,A=document.createElement(N),ye,K;const{hasEventListeners:G}=Ui();let Me=typeof B=="boolean"&&B===!0?[be]:Array.isArray(B)?B:void 0;const Ne=jt(ce,C=>C.width/2);Qe(n,Ne,C=>l(39,a=C));const Oe=jt(ce,C=>C.height/2);Qe(n,Oe,C=>l(38,o=C));let le={common:{el:nt({})},transform:{el:nt({position:"absolute",top:"0",left:"0",pointerEvents:"none",overflow:"hidden",display:"block",width:`${i.width}px`,height:`${i.height}px`}),outerRef:nt({position:"absolute",top:"0",left:"0",width:`${i.width}px`,height:`${i.height}px`,transformStyle:"preserve-3d",pointerEvents:"none"}),innerRef:nt({position:"absolute",pointerEvents:Y})},noTransform:{el:nt({}),div:nt({position:"absolute",transform:v?"translate3d(-50%,-50%,0)":"none",top:L?`${-o}px`:void 0,left:L?`${-a}px`:void 0,width:L?`${i.width}px`:void 0,height:L?`${i.height}px`:void 0})}};const ze=jt([le.transform.el,le.common.el],([C,pe])=>({...C,...pe}));Qe(n,ze,C=>l(8,c=C));const Ae=jt(le.transform.outerRef,C=>C);Qe(n,Ae,C=>l(9,u=C));const Mt=jt(le.transform.innerRef,C=>C);Qe(n,Mt,C=>l(10,m=C));const dt=jt(le.noTransform.el,C=>C);Qe(n,dt,C=>l(11,_=C));const Ut=jt(le.noTransform.div,C=>C);Qe(n,Ut,C=>l(12,g=C));const At=()=>{let C=!0,pe=U.parent;e:for(;pe;){if("visible"in pe&&!pe.visible){C=!1;break e}pe=pe.parent}return C};let Ke=At();fl(async()=>{l(6,Ke=At());const C=Le();C.updateMatrixWorld(),U.updateWorldMatrix(!0,!1);const pe=w?Pe:j(U,C,i);if(w||Math.abs(ue-C.zoom)>z||Math.abs(Pe[0]-pe[0])>z||Math.abs(Pe[1]-pe[1])>z){const Nt=ei(U,C),gt=ge;if(Me){const ot=ti(U,C,de,Me);l(26,ge=ot&&!Nt)}else l(26,ge=!Nt);if(gt!==ge&&(G("visibilitychange")?se("visibilitychange",ge):kt(le.common.el,{display:ge?"block":"none"})),kt(le.common.el,{zIndex:`${ni(U,C,I)}`}),w){const ot=C.projectionMatrix.elements[5]*o,{isOrthographicCamera:at,top:Rt,left:rt,bottom:d,right:F}=C;let J=U.matrixWorld;if(H&&(J=C.matrixWorldInverse.clone().transpose().copyPosition(J).scale(U.scale),J.elements[3]=J.elements[7]=J.elements[11]=0,J.elements[15]=1),kt(le.transform.el,{perspective:at?"":`${ot}px`}),ye&&K){const me=at?`scale(${ot}) translate(${pl(-(F+rt)/2)}px,${pl((Rt+d)/2)}px)`:`translateZ(${ot}px)`,he=li(C.matrixWorldInverse);kt(le.transform.outerRef,{transform:`${me}${he}translate(${a}px, ${o}px)`}),kt(le.transform.innerRef,{transform:si(J,1/((Q||10)/400))})}}else{const ot=Q===void 0?1:ii(U,C)*Q;kt(le.noTransform.el,{transform:`translate3d(${pe[0]}px, ${pe[1]}px, 0) scale(${ot})`})}Pe=pe,ue=C.zoom}});const It=C=>{if(!U||w)return;be.updateMatrixWorld();const pe=j(U,r,i);kt(le.noTransform.el,{position:"absolute",top:"0",left:"0",transform:`translate3d(${pe[0]}px, ${pe[1]}px, 0)`,transformOrigin:"0 0"})},Re=C=>{const pe=re??Z.domElement.parentElement;if(!pe){console.warn("HTML: target is undefined.");return}return pe.appendChild(C),{destroy:()=>{C.parentNode&&C.parentNode.removeChild(C)}}},Lt=Dn();Qe(n,Lt,C=>l(7,f=C));function ht(C){$e[C?"unshift":"push"](()=>{f=C,Lt.set(f)})}function it(C){$e[C?"unshift":"push"](()=>{K=C,l(5,K)})}function Bt(C){$e[C?"unshift":"push"](()=>{ye=C,l(4,ye)})}function Et(C){$e[C?"unshift":"push"](()=>{A=C,l(3,A)})}function Ht(C){$e[C?"unshift":"push"](()=>{A=C,l(3,A)})}return n.$$set=C=>{t=Xe(Xe({},t),rn(C)),l(25,s=Ct(t,e)),"transform"in C&&l(0,w=C.transform),"calculatePosition"in C&&l(27,j=C.calculatePosition),"eps"in C&&l(28,z=C.eps),"occlude"in C&&l(29,B=C.occlude),"zIndexRange"in C&&l(30,I=C.zIndexRange),"sprite"in C&&l(31,H=C.sprite),"pointerEvents"in C&&l(32,Y=C.pointerEvents),"center"in C&&l(33,v=C.center),"fullscreen"in C&&l(34,L=C.fullscreen),"distanceFactor"in C&&l(35,Q=C.distanceFactor),"as"in C&&l(1,N=C.as),"portal"in C&&l(36,re=C.portal),"ref"in C&&l(2,U=C.ref),"visible"in C&&l(26,ge=C.visible),"$$scope"in C&&l(46,k=C.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&536870912&&(Me=typeof B=="boolean"&&B===!0?[be]:Array.isArray(B)?B:void 0),n.$$.dirty[1]&64&&kt(le.transform.el,{width:`${i.width}px`,height:`${i.height}px`}),n.$$.dirty[1]&64&&kt(le.transform.outerRef,{width:`${i.width}px`,height:`${i.height}px`}),n.$$.dirty[1]&2&&kt(le.transform.innerRef,{pointerEvents:Y}),n.$$.dirty[1]&2&&kt(le.noTransform.div,{pointerEvents:Y}),n.$$.dirty[1]&4&&kt(le.noTransform.div,{transform:v?"translate3d(-50%, -50%, 0)":"none"}),n.$$.dirty[1]&456&&kt(le.noTransform.div,{top:L?`${-o}px`:void 0,left:L?`${-a}px`:void 0,width:L?`${i.width}px`:void 0,height:L?`${i.height}px`:void 0})},[w,N,U,A,ye,K,Ke,f,c,u,m,_,g,ie,ce,Ne,Oe,ze,Ae,Mt,dt,Ut,It,Re,Lt,s,ge,j,z,B,I,H,Y,v,L,Q,re,i,o,a,T,ht,it,Bt,Et,Ht,k]}class Ds extends Ot{constructor(t){super(),Pt(this,t,Zi,Fi,st,{transform:0,calculatePosition:27,eps:28,occlude:29,zIndexRange:30,sprite:31,pointerEvents:32,center:33,fullscreen:34,distanceFactor:35,as:1,portal:36,ref:2,visible:26},null,[-1,-1])}}const Wi=()=>Vi("threlte-controls",{orbitControls:nt(void 0),trackballControls:nt(void 0)}),Ll={type:"change"},xn={type:"start"},Nl={type:"end"},On=new oi,zl=new ai,Gi=Math.cos(70*ri.DEG2RAD);let Xi=class extends ci{constructor(t,l){super(),this.object=t,this.domElement=l,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new Be,this.cursor=new Be,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:tn.ROTATE,MIDDLE:tn.DOLLY,RIGHT:tn.PAN},this.touches={ONE:nn.ROTATE,TWO:nn.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return o.phi},this.getAzimuthalAngle=function(){return o.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(d){d.addEventListener("keydown",C),this._domElementKeyEvents=d},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",C),this._domElementKeyEvents=null},this.saveState=function(){e.target0.copy(e.target),e.position0.copy(e.object.position),e.zoom0=e.object.zoom},this.reset=function(){e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.zoom=e.zoom0,e.object.updateProjectionMatrix(),e.dispatchEvent(Ll),e.update(),i=s.NONE},this.update=function(){const d=new Be,F=new Rn().setFromUnitVectors(t.up,new Be(0,1,0)),J=F.clone().invert(),me=new Be,he=new Rn,bt=new Be,ke=2*Math.PI;return function(Zt=null){const Wt=e.object.position;d.copy(Wt).sub(e.target),d.applyQuaternion(F),o.setFromVector3(d),e.autoRotate&&i===s.NONE&&re(Q(Zt)),e.enableDamping?(o.theta+=a.theta*e.dampingFactor,o.phi+=a.phi*e.dampingFactor):(o.theta+=a.theta,o.phi+=a.phi);let je=e.minAzimuthAngle,et=e.maxAzimuthAngle;isFinite(je)&&isFinite(et)&&(je<-Math.PI?je+=ke:je>Math.PI&&(je-=ke),et<-Math.PI?et+=ke:et>Math.PI&&(et-=ke),je<=et?o.theta=Math.max(je,Math.min(et,o.theta)):o.theta=o.theta>(je+et)/2?Math.max(je,o.theta):Math.min(et,o.theta)),o.phi=Math.max(e.minPolarAngle,Math.min(e.maxPolarAngle,o.phi)),o.makeSafe(),e.enableDamping===!0?e.target.addScaledVector(c,e.dampingFactor):e.target.add(c),e.target.sub(e.cursor),e.target.clampLength(e.minTargetRadius,e.maxTargetRadius),e.target.add(e.cursor),e.zoomToCursor&&H||e.object.isOrthographicCamera?o.radius=Le(o.radius):o.radius=Le(o.radius*f),d.setFromSpherical(o),d.applyQuaternion(J),Wt.copy(e.target).add(d),e.object.lookAt(e.target),e.enableDamping===!0?(a.theta*=1-e.dampingFactor,a.phi*=1-e.dampingFactor,c.multiplyScalar(1-e.dampingFactor)):(a.set(0,0,0),c.set(0,0,0));let Kt=!1;if(e.zoomToCursor&&H){let tt=null;if(e.object.isPerspectiveCamera){const zt=d.length();tt=Le(zt*f);const yt=zt-tt;e.object.position.addScaledVector(B,yt),e.object.updateMatrixWorld()}else if(e.object.isOrthographicCamera){const zt=new Be(I.x,I.y,0);zt.unproject(e.object),e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/f)),e.object.updateProjectionMatrix(),Kt=!0;const yt=new Be(I.x,I.y,0);yt.unproject(e.object),e.object.position.sub(yt).add(zt),e.object.updateMatrixWorld(),tt=d.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),e.zoomToCursor=!1;tt!==null&&(this.screenSpacePanning?e.target.set(0,0,-1).transformDirection(e.object.matrix).multiplyScalar(tt).add(e.object.position):(On.origin.copy(e.object.position),On.direction.set(0,0,-1).transformDirection(e.object.matrix),Math.abs(e.object.up.dot(On.direction))<Gi?t.lookAt(e.target):(zl.setFromNormalAndCoplanarPoint(e.object.up,e.target),On.intersectPlane(zl,e.target))))}else e.object.isOrthographicCamera&&(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/f)),e.object.updateProjectionMatrix(),Kt=!0);return f=1,H=!1,Kt||me.distanceToSquared(e.object.position)>r||8*(1-he.dot(e.object.quaternion))>r||bt.distanceToSquared(e.target)>0?(e.dispatchEvent(Ll),me.copy(e.object.position),he.copy(e.object.quaternion),bt.copy(e.target),!0):!1}}(),this.dispose=function(){e.domElement.removeEventListener("contextmenu",gt),e.domElement.removeEventListener("pointerdown",Ke),e.domElement.removeEventListener("pointercancel",Re),e.domElement.removeEventListener("wheel",it),e.domElement.removeEventListener("pointermove",It),e.domElement.removeEventListener("pointerup",Re),e._domElementKeyEvents!==null&&(e._domElementKeyEvents.removeEventListener("keydown",C),e._domElementKeyEvents=null)};const e=this,s={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let i=s.NONE;const r=1e-6,o=new vl,a=new vl;let f=1;const c=new Be,u=new wt,m=new wt,_=new wt,g=new wt,T=new wt,k=new wt,w=new wt,j=new wt,z=new wt,B=new Be,I=new wt;let H=!1;const Y=[],v={};let L=!1;function Q(d){return d!==null?2*Math.PI/60*e.autoRotateSpeed*d:2*Math.PI/60/60*e.autoRotateSpeed}function N(d){const F=Math.abs(d*.01);return Math.pow(.95,e.zoomSpeed*F)}function re(d){a.theta-=d}function se(d){a.phi-=d}const U=function(){const d=new Be;return function(J,me){d.setFromMatrixColumn(me,0),d.multiplyScalar(-J),c.add(d)}}(),Z=function(){const d=new Be;return function(J,me){e.screenSpacePanning===!0?d.setFromMatrixColumn(me,1):(d.setFromMatrixColumn(me,0),d.crossVectors(e.object.up,d)),d.multiplyScalar(J),c.add(d)}}(),ie=function(){const d=new Be;return function(J,me){const he=e.domElement;if(e.object.isPerspectiveCamera){const bt=e.object.position;d.copy(bt).sub(e.target);let ke=d.length();ke*=Math.tan(e.object.fov/2*Math.PI/180),U(2*J*ke/he.clientHeight,e.object.matrix),Z(2*me*ke/he.clientHeight,e.object.matrix)}else e.object.isOrthographicCamera?(U(J*(e.object.right-e.object.left)/e.object.zoom/he.clientWidth,e.object.matrix),Z(me*(e.object.top-e.object.bottom)/e.object.zoom/he.clientHeight,e.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),e.enablePan=!1)}}();function be(d){e.object.isPerspectiveCamera||e.object.isOrthographicCamera?f/=d:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function ce(d){e.object.isPerspectiveCamera||e.object.isOrthographicCamera?f*=d:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function fe(d,F){if(!e.zoomToCursor)return;H=!0;const J=e.domElement.getBoundingClientRect(),me=d-J.left,he=F-J.top,bt=J.width,ke=J.height;I.x=me/bt*2-1,I.y=-(he/ke)*2+1,B.set(I.x,I.y,1).unproject(e.object).sub(e.object.position).normalize()}function Le(d){return Math.max(e.minDistance,Math.min(e.maxDistance,d))}function de(d){u.set(d.clientX,d.clientY)}function Pe(d){fe(d.clientX,d.clientX),w.set(d.clientX,d.clientY)}function ue(d){g.set(d.clientX,d.clientY)}function ge(d){m.set(d.clientX,d.clientY),_.subVectors(m,u).multiplyScalar(e.rotateSpeed);const F=e.domElement;re(2*Math.PI*_.x/F.clientHeight),se(2*Math.PI*_.y/F.clientHeight),u.copy(m),e.update()}function A(d){j.set(d.clientX,d.clientY),z.subVectors(j,w),z.y>0?be(N(z.y)):z.y<0&&ce(N(z.y)),w.copy(j),e.update()}function ye(d){T.set(d.clientX,d.clientY),k.subVectors(T,g).multiplyScalar(e.panSpeed),ie(k.x,k.y),g.copy(T),e.update()}function K(d){fe(d.clientX,d.clientY),d.deltaY<0?ce(N(d.deltaY)):d.deltaY>0&&be(N(d.deltaY)),e.update()}function G(d){let F=!1;switch(d.code){case e.keys.UP:d.ctrlKey||d.metaKey||d.shiftKey?se(2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):ie(0,e.keyPanSpeed),F=!0;break;case e.keys.BOTTOM:d.ctrlKey||d.metaKey||d.shiftKey?se(-2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):ie(0,-e.keyPanSpeed),F=!0;break;case e.keys.LEFT:d.ctrlKey||d.metaKey||d.shiftKey?re(2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):ie(e.keyPanSpeed,0),F=!0;break;case e.keys.RIGHT:d.ctrlKey||d.metaKey||d.shiftKey?re(-2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):ie(-e.keyPanSpeed,0),F=!0;break}F&&(d.preventDefault(),e.update())}function Me(d){if(Y.length===1)u.set(d.pageX,d.pageY);else{const F=rt(d),J=.5*(d.pageX+F.x),me=.5*(d.pageY+F.y);u.set(J,me)}}function Ne(d){if(Y.length===1)g.set(d.pageX,d.pageY);else{const F=rt(d),J=.5*(d.pageX+F.x),me=.5*(d.pageY+F.y);g.set(J,me)}}function Oe(d){const F=rt(d),J=d.pageX-F.x,me=d.pageY-F.y,he=Math.sqrt(J*J+me*me);w.set(0,he)}function le(d){e.enableZoom&&Oe(d),e.enablePan&&Ne(d)}function ze(d){e.enableZoom&&Oe(d),e.enableRotate&&Me(d)}function Ae(d){if(Y.length==1)m.set(d.pageX,d.pageY);else{const J=rt(d),me=.5*(d.pageX+J.x),he=.5*(d.pageY+J.y);m.set(me,he)}_.subVectors(m,u).multiplyScalar(e.rotateSpeed);const F=e.domElement;re(2*Math.PI*_.x/F.clientHeight),se(2*Math.PI*_.y/F.clientHeight),u.copy(m)}function Mt(d){if(Y.length===1)T.set(d.pageX,d.pageY);else{const F=rt(d),J=.5*(d.pageX+F.x),me=.5*(d.pageY+F.y);T.set(J,me)}k.subVectors(T,g).multiplyScalar(e.panSpeed),ie(k.x,k.y),g.copy(T)}function dt(d){const F=rt(d),J=d.pageX-F.x,me=d.pageY-F.y,he=Math.sqrt(J*J+me*me);j.set(0,he),z.set(0,Math.pow(j.y/w.y,e.zoomSpeed)),be(z.y),w.copy(j);const bt=(d.pageX+F.x)*.5,ke=(d.pageY+F.y)*.5;fe(bt,ke)}function Ut(d){e.enableZoom&&dt(d),e.enablePan&&Mt(d)}function At(d){e.enableZoom&&dt(d),e.enableRotate&&Ae(d)}function Ke(d){e.enabled!==!1&&(Y.length===0&&(e.domElement.setPointerCapture(d.pointerId),e.domElement.addEventListener("pointermove",It),e.domElement.addEventListener("pointerup",Re)),ot(d),d.pointerType==="touch"?pe(d):Lt(d))}function It(d){e.enabled!==!1&&(d.pointerType==="touch"?Nt(d):ht(d))}function Re(d){at(d),Y.length===0&&(e.domElement.releasePointerCapture(d.pointerId),e.domElement.removeEventListener("pointermove",It),e.domElement.removeEventListener("pointerup",Re)),e.dispatchEvent(Nl),i=s.NONE}function Lt(d){let F;switch(d.button){case 0:F=e.mouseButtons.LEFT;break;case 1:F=e.mouseButtons.MIDDLE;break;case 2:F=e.mouseButtons.RIGHT;break;default:F=-1}switch(F){case tn.DOLLY:if(e.enableZoom===!1)return;Pe(d),i=s.DOLLY;break;case tn.ROTATE:if(d.ctrlKey||d.metaKey||d.shiftKey){if(e.enablePan===!1)return;ue(d),i=s.PAN}else{if(e.enableRotate===!1)return;de(d),i=s.ROTATE}break;case tn.PAN:if(d.ctrlKey||d.metaKey||d.shiftKey){if(e.enableRotate===!1)return;de(d),i=s.ROTATE}else{if(e.enablePan===!1)return;ue(d),i=s.PAN}break;default:i=s.NONE}i!==s.NONE&&e.dispatchEvent(xn)}function ht(d){switch(i){case s.ROTATE:if(e.enableRotate===!1)return;ge(d);break;case s.DOLLY:if(e.enableZoom===!1)return;A(d);break;case s.PAN:if(e.enablePan===!1)return;ye(d);break}}function it(d){e.enabled===!1||e.enableZoom===!1||i!==s.NONE||(d.preventDefault(),e.dispatchEvent(xn),K(Bt(d)),e.dispatchEvent(Nl))}function Bt(d){const F=d.deltaMode,J={clientX:d.clientX,clientY:d.clientY,deltaY:d.deltaY};switch(F){case 1:J.deltaY*=16;break;case 2:J.deltaY*=100;break}return d.ctrlKey&&!L&&(J.deltaY*=10),J}function Et(d){d.key==="Control"&&(L=!0,document.addEventListener("keyup",Ht,{passive:!0,capture:!0}))}function Ht(d){d.key==="Control"&&(L=!1,document.removeEventListener("keyup",Ht,{passive:!0,capture:!0}))}function C(d){e.enabled===!1||e.enablePan===!1||G(d)}function pe(d){switch(Rt(d),Y.length){case 1:switch(e.touches.ONE){case nn.ROTATE:if(e.enableRotate===!1)return;Me(d),i=s.TOUCH_ROTATE;break;case nn.PAN:if(e.enablePan===!1)return;Ne(d),i=s.TOUCH_PAN;break;default:i=s.NONE}break;case 2:switch(e.touches.TWO){case nn.DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;le(d),i=s.TOUCH_DOLLY_PAN;break;case nn.DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;ze(d),i=s.TOUCH_DOLLY_ROTATE;break;default:i=s.NONE}break;default:i=s.NONE}i!==s.NONE&&e.dispatchEvent(xn)}function Nt(d){switch(Rt(d),i){case s.TOUCH_ROTATE:if(e.enableRotate===!1)return;Ae(d),e.update();break;case s.TOUCH_PAN:if(e.enablePan===!1)return;Mt(d),e.update();break;case s.TOUCH_DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;Ut(d),e.update();break;case s.TOUCH_DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;At(d),e.update();break;default:i=s.NONE}}function gt(d){e.enabled!==!1&&d.preventDefault()}function ot(d){Y.push(d.pointerId)}function at(d){delete v[d.pointerId];for(let F=0;F<Y.length;F++)if(Y[F]==d.pointerId){Y.splice(F,1);return}}function Rt(d){let F=v[d.pointerId];F===void 0&&(F=new wt,v[d.pointerId]=F),F.set(d.pageX,d.pageY)}function rt(d){const F=d.pointerId===Y[0]?Y[1]:Y[0];return v[F]}e.domElement.addEventListener("contextmenu",gt),e.domElement.addEventListener("pointerdown",Ke),e.domElement.addEventListener("pointercancel",Re),e.domElement.addEventListener("wheel",it,{passive:!1}),document.addEventListener("keydown",Et,{passive:!0,capture:!0}),this.update()}};const qi=n=>({ref:n&1}),Al=n=>({ref:n[0]});function Qi(n){let t;const l=n[6].default,e=Fe(l,n,n[8],Al);return{c(){e&&e.c()},l(s){e&&e.l(s)},m(s,i){e&&e.m(s,i),t=!0},p(s,i){e&&e.p&&(!t||i&257)&&Ze(e,l,s,s[8],t?Ge(l,s[8],i,qi):We(s[8]),Al)},i(s){t||(p(e,s),t=!0)},o(s){S(e,s),t=!1},d(s){e&&e.d(s)}}}function Ji(n){let t,l;const e=[{is:n[0]},n[5]];let s={$$slots:{default:[Qi,({ref:i})=>({0:i}),({ref:i})=>i?1:0]},$$scope:{ctx:n}};for(let i=0;i<e.length;i+=1)s=Xe(s,e[i]);return t=new Ce({props:s}),n[7](t),t.$on("change",n[3]),{c(){$(t.$$.fragment)},l(i){ee(t.$$.fragment,i)},m(i,r){te(t,i,r),l=!0},p(i,[r]){const o=r&33?Jt(e,[r&1&&{is:i[0]},r&32&&cn(i[5])]):{};r&257&&(o.$$scope={dirty:r,ctx:i}),t.$set(o)},i(i){l||(p(t.$$.fragment,i),l=!0)},o(i){S(t.$$.fragment,i),l=!1},d(i){n[7](null),ne(t,i)}}}function xi(n,t,l){const e=["ref"];let s=Ct(t,e),i,r,{$$slots:o={},$$scope:a}=t;const f=fi();Qe(n,f,z=>l(9,i=z));const c=z=>z.isCamera,{renderer:u,invalidate:m}=pn();if(!c(i))throw new Error("Parent missing: <OrbitControls> need to be a child of a <Camera>");const _=new Xi(i,u.domElement),{start:g,stop:T}=fl(_.update,{autoStart:!1,autoInvalidate:!1}),k=Dn();Qe(n,k,z=>l(1,r=z));const{orbitControls:w}=Wi();w.set(_),an(()=>w.set(void 0));function j(z){$e[z?"unshift":"push"](()=>{r=z,k.set(r)})}return n.$$set=z=>{t=Xe(Xe({},t),rn(z)),l(5,s=Ct(t,e)),"$$scope"in z&&l(8,a=z.$$scope)},n.$$.update=()=>{s.autoRotate||s.enableDamping?g():T()},[_,r,f,m,k,s,o,j,a]}class $i extends Ot{constructor(t){super(),Pt(this,t,xi,Ji,st,{ref:0})}get ref(){return this.$$.ctx[0]}}const Vs=n=>`threlte-instanced-mesh-${n}`,eo=(n,t)=>{const l={instancedMesh:xe(n),addInstance(e){l.instances.update(s=>(s.push(e),s))},removeInstance(e){l.instances.update(s=>{const i=s.indexOf(e);return i>-1&&s.splice(i,1),s})},instances:xe([])};return Ft(Vs(t),l),l},to=n=>{const t=on(Vs(n));if(!t)throw new Error(`No <InstancedMesh> component found for id ${n}`);return t};function no(n){let t,l,e,s,i;t=new Ce.InstancedBufferAttribute({props:{attach:"instanceMatrix",count:n[1].length/16,array:n[1],itemSize:16,usage:yl}}),e=new Ce.InstancedBufferAttribute({props:{attach:"instanceColor",count:n[2].length/3,array:n[2],itemSize:3,usage:yl}});const r=n[10].default,o=Fe(r,n,n[9],null);return{c(){$(t.$$.fragment),l=D(),$(e.$$.fragment),s=D(),o&&o.c()},l(a){ee(t.$$.fragment,a),l=V(a),ee(e.$$.fragment,a),s=V(a),o&&o.l(a)},m(a,f){te(t,a,f),O(a,l,f),te(e,a,f),O(a,s,f),o&&o.m(a,f),i=!0},p(a,[f]){o&&o.p&&(!i||f&512)&&Ze(o,r,a,a[9],i?Ge(r,a[9],f,null):We(a[9]),null)},i(a){i||(p(t.$$.fragment,a),p(e.$$.fragment,a),p(o,a),i=!0)},o(a){S(t.$$.fragment,a),S(e.$$.fragment,a),S(o,a),i=!1},d(a){a&&(b(l),b(s)),ne(t,a),ne(e,a),o&&o.d(a)}}}function lo(n,t,l){let e,{$$slots:s={},$$scope:i}=t,{instancedMesh:r}=t,{id:o}=t,{limit:a}=t,{range:f}=t,{update:c}=t;const{instances:u}=eo(r,o);Qe(n,u,I=>l(8,e=I));const m=new In,_=new Float32Array(a*16);for(let I=0;I<a;I++)m.identity().toArray(_,I*16);const g=new Float32Array(a*3).fill(1),T=new In,k=new In,w=new Be,j=new Rn,z=new Be;let B=!1;return fl(()=>{if(r.updateMatrix(),c||!B){r.updateMatrixWorld(),T.copy(r.matrixWorld).invert(),r.instanceColor&&l(3,r.instanceColor.needsUpdate=!0,r),l(3,r.instanceMatrix.needsUpdate=!0,r);for(let I=0;I<u.current.length;I++){const H=u.current[I];H.matrixWorld.decompose(w,j,z),k.compose(w,j,z).premultiply(T),k.toArray(_,I*16),H.color.toArray(g,I*3)}B=!0}}),n.$$set=I=>{"instancedMesh"in I&&l(3,r=I.instancedMesh),"id"in I&&l(4,o=I.id),"limit"in I&&l(5,a=I.limit),"range"in I&&l(6,f=I.range),"update"in I&&l(7,c=I.update),"$$scope"in I&&l(9,i=I.$$scope)},n.$$.update=()=>{if(n.$$.dirty&360){const I=Math.min(a,f!==void 0?f:a,e.length);l(3,r.count=I,r),sn>=159?(r.instanceMatrix.clearUpdateRanges(),r.instanceMatrix.addUpdateRange(0,I*16)):l(3,r.instanceMatrix.updateRange.count=I*16,r),r.instanceColor&&(sn>=159?(r.instanceColor.clearUpdateRanges(),r.instanceColor.addUpdateRange(0,I*3)):l(3,r.instanceColor.updateRange.count=I*3,r))}},[u,_,g,r,o,a,f,c,e,i,s]}class so extends Ot{constructor(t){super(),Pt(this,t,lo,no,st,{instancedMesh:3,id:4,limit:5,range:6,update:7})}}const io=n=>({}),Rl=n=>({ref:n[4]});function oo(n){let t;const l=n[9].default,e=Fe(l,n,n[11],Rl);return{c(){e&&e.c()},l(s){e&&e.l(s)},m(s,i){e&&e.m(s,i),t=!0},p(s,i){e&&e.p&&(!t||i&2048)&&Ze(e,l,s,s[11],t?Ge(l,s[11],i,io):We(s[11]),Rl)},i(s){t||(p(e,s),t=!0)},o(s){S(e,s),t=!1},d(s){e&&e.d(s)}}}function ao(n){let t,l;return t=new so({props:{instancedMesh:n[4],id:n[0],limit:n[1],range:n[2],update:n[3],$$slots:{default:[oo]},$$scope:{ctx:n}}}),{c(){$(t.$$.fragment)},l(e){ee(t.$$.fragment,e)},m(e,s){te(t,e,s),l=!0},p(e,s){const i={};s&1&&(i.id=e[0]),s&2&&(i.limit=e[1]),s&4&&(i.range=e[2]),s&8&&(i.update=e[3]),s&2048&&(i.$$scope={dirty:s,ctx:e}),t.$set(i)},i(e){l||(p(t.$$.fragment,e),l=!0)},o(e){S(t.$$.fragment,e),l=!1},d(e){ne(t,e)}}}function ro(n){let t,l,e;const s=[{is:n[4]},{raycast:co},{matrixAutoUpdate:!1},{args:n[7]},n[8]];function i(o){n[10](o)}let r={$$slots:{default:[ao]},$$scope:{ctx:n}};for(let o=0;o<s.length;o+=1)r=Xe(r,s[o]);return n[5]!==void 0&&(r.bind=n[5]),t=new Ce({props:r}),$e.push(()=>An(t,"bind",i)),{c(){$(t.$$.fragment)},l(o){ee(t.$$.fragment,o)},m(o,a){te(t,o,a),e=!0},p(o,[a]){const f=a&400?Jt(s,[a&16&&{is:o[4]},s[1],s[2],a&128&&{args:o[7]},a&256&&cn(o[8])]):{};a&2063&&(f.$$scope={dirty:a,ctx:o}),!l&&a&32&&(l=!0,f.bind=o[5],zn(()=>l=!1)),t.$set(f)},i(o){e||(p(t.$$.fragment,o),e=!0)},o(o){S(t.$$.fragment,o),e=!1},d(o){ne(t,o)}}}const co=()=>null;function fo(n,t,l){const e=["id","limit","range","update","ref"];let s=Ct(t,e),i,{$$slots:r={},$$scope:o}=t,{id:a="default"}=t,{limit:f=1e3}=t,{range:c=1e3}=t,{update:u=!0}=t;const m=new ui(null,null,0),_=Dn();Qe(n,_,k=>l(5,i=k));const g=[null,null,0];function T(k){i=k,_.set(i)}return n.$$set=k=>{t=Xe(Xe({},t),rn(k)),l(8,s=Ct(t,e)),"id"in k&&l(0,a=k.id),"limit"in k&&l(1,f=k.limit),"range"in k&&l(2,c=k.range),"update"in k&&l(3,u=k.update),"$$scope"in k&&l(11,o=k.$$scope)},[a,f,c,u,m,i,_,g,s,r,T,o]}class bn extends Ot{constructor(t){super(),Pt(this,t,fo,ro,st,{id:0,limit:1,range:2,update:3,ref:4})}get ref(){return this.$$.ctx[4]}}const uo=n=>({}),jl=n=>({ref:n[0]});function mo(n){let t;const l=n[5].default,e=Fe(l,n,n[7],jl);return{c(){e&&e.c()},l(s){e&&e.l(s)},m(s,i){e&&e.m(s,i),t=!0},p(s,i){e&&e.p&&(!t||i&128)&&Ze(e,l,s,s[7],t?Ge(l,s[7],i,uo):We(s[7]),jl)},i(s){t||(p(e,s),t=!0)},o(s){S(e,s),t=!1},d(s){e&&e.d(s)}}}function _o(n){let t,l;const e=[{is:n[0]},n[3]];let s={$$slots:{default:[mo]},$$scope:{ctx:n}};for(let i=0;i<e.length;i+=1)s=Xe(s,e[i]);return t=new Ce({props:s}),n[6](t),{c(){$(t.$$.fragment)},l(i){ee(t.$$.fragment,i)},m(i,r){te(t,i,r),l=!0},p(i,[r]){const o=r&9?Jt(e,[r&1&&{is:i[0]},r&8&&cn(i[3])]):{};r&128&&(o.$$scope={dirty:r,ctx:i}),t.$set(o)},i(i){l||(p(t.$$.fragment,i),l=!0)},o(i){S(t.$$.fragment,i),l=!1},d(i){n[6](null),ne(t,i)}}}function ho(n,t,l){const e=["id","ref"];let s=Ct(t,e),i,{$$slots:r={},$$scope:o}=t,{id:a="default"}=t;const{addInstance:f,removeInstance:c,instancedMesh:u,instances:m}=to(a),_=new mi(u,m);f(_),an(()=>{c(_)});const g=Dn();Qe(n,g,k=>l(1,i=k));function T(k){$e[k?"unshift":"push"](()=>{i=k,g.set(i)})}return n.$$set=k=>{t=Xe(Xe({},t),rn(k)),l(3,s=Ct(t,e)),"id"in k&&l(4,a=k.id),"$$scope"in k&&l(7,o=k.$$scope)},[_,i,g,s,a,r,T,o]}class Us extends Ot{constructor(t){super(),Pt(this,t,ho,_o,st,{id:4,ref:0})}get ref(){return this.$$.ctx[0]}}const go=n=>{const t=Rs(pn().camera);let l=0,e=0;const s=new ResizeObserver(i=>{for(const r of i)l=r.contentRect.width,e=r.contentRect.height});return pt(n.target,i=>(i&&s.observe(i),()=>{i&&s.unobserve(i)})),(i,r)=>{r.pointer.update(o=>(o.set(i.offsetX/l*2-1,-(i.offsetY/e)*2+1),o)),r.raycaster.setFromCamera(r.pointer.current,t.current)}},bo=()=>{const n=on("threlte-interactivity-context"),t=Ns();return{...n,addInteractiveObject:s=>{if(!n){console.warn("No interactivity context found. Did you forget to implement interactivity()?");return}s.userData._threlte_interactivity_dispatcher=t,!n.interactiveObjects.some(i=>i.uuid===s.uuid)&&n.interactiveObjects.push(s)},removeInteractiveObject:s=>{if(!n){console.warn("No interactivity context found. Did you forget to implement interactivity()?");return}n.interactiveObjects=n.interactiveObjects.filter(i=>i.uuid!==s.uuid),delete s.userData._threlte_interactivity_dispatcher}}},po=n=>{const t=rl(),l=nt(!1);return Ps(()=>{l.set(Object.keys(t.$$.callbacks).some(e=>n.includes(e)))}),{hasEventHandlers:l}},vo=["click","contextmenu","dblclick","wheel","pointerup","pointerdown","pointerover","pointerout","pointerenter","pointerleave","pointermove","pointermissed"],yo=()=>{Di("interactivity",({ref:n})=>{if(!n.isObject3D)return;const{addInteractiveObject:t,removeInteractiveObject:l}=bo(),e=nt(n),{hasEventHandlers:s}=po(vo);return pt([s,e],([i,r])=>{if(i)return t(r),()=>l(r)}),{onRefChange(i){e.set(i)}}})},Pn=n=>n.userData._threlte_interactivity_dispatcher;function $n(n){return(n.eventObject||n.object).uuid+"/"+n.index+n.instanceId}const Dl=[["click",!1],["contextmenu",!1],["dblclick",!1],["wheel",!1],["pointerdown",!0],["pointerup",!0],["pointerleave",!0],["pointerenter",!0],["pointermove",!0],["pointercancel",!0]],ko=n=>{function t(f){const c=f.offsetX-n.initialClick[0],u=f.offsetY-n.initialClick[1];return Math.round(Math.sqrt(c*c+u*u))}function l(f){for(const c of n.hovered.values())if(!f.length||!f.find(u=>u.object===c.object&&u.index===c.index&&u.instanceId===c.instanceId)){const u=c.eventObject;n.hovered.delete($n(c));const m=Pn(u);if(m){const _={...c,intersections:f};m("pointerout",_),m("pointerleave",_)}}}const e=Rs(n.enabled),s=()=>{const f=new Set,c=[];let u=n.interactiveObjects.flatMap(m=>e.current?n.raycaster.intersectObject(m,!0):[]).sort((m,_)=>m.distance-_.distance).filter(m=>{const _=$n(m);return f.has(_)?!1:(f.add(_),!0)});n.filter&&(u=n.filter(u,n));for(const m of u){let _=m.object;for(;_;)Pn(_)&&c.push({...m,eventObject:_}),_=_.parent}return c};function i(f,c){for(const u of c){const m=Pn(u);m&&m("pointermissed",f)}}const r=f=>f==="pointerleave"||f==="pointercancel"?()=>{n.pointerOverTarget.set(!1),l([])}:f==="pointerenter"?()=>{n.pointerOverTarget.set(!0)}:c=>{const u=f==="pointermove",m=f==="click"||f==="contextmenu"||f==="dblclick";n.compute(c,n);const _=s(),g=m?t(c):0;f==="pointerdown"&&(n.initialClick=[c.offsetX,c.offsetY],n.initialHits=_.map(k=>k.eventObject)),m&&!_.length&&g<=2&&i(c,n.interactiveObjects),u&&l(_);let T=!1;e:for(const k of _){const w={stopped:T,...k,intersections:_,stopPropagation(){if(T=!0,w.stopped=!0,n.hovered.size&&Array.from(n.hovered.values()).find(z=>z.eventObject===k.eventObject)){const z=_.slice(0,_.indexOf(k));l([...z,k])}},camera:n.raycaster.camera,delta:g,nativeEvent:c,pointer:n.pointer.current,ray:n.raycaster.ray},j=Pn(k.eventObject);if(!j)return;if(u){if(j.hasEventListener("pointerover")||j.hasEventListener("pointerenter")||j.hasEventListener("pointerout")||j.hasEventListener("pointerleave")){const z=$n(w),B=n.hovered.get(z);B?B.stopped&&w.stopPropagation():(n.hovered.set(z,w),j("pointerover",w),j("pointerenter",w))}j("pointermove",w)}else j.hasEventListener(f)?(!m||n.initialHits.includes(k.eventObject))&&(i(c,n.interactiveObjects.filter(B=>!n.initialHits.includes(B))),j(f,w)):m&&n.initialHits.includes(k.eventObject)&&i(c,n.interactiveObjects.filter(B=>!n.initialHits.includes(B)));if(T)break e}},o=f=>{Dl.forEach(([c])=>{f.removeEventListener(c,r(c))})},a=f=>{Dl.forEach(([c,u])=>{f.addEventListener(c,r(c),{passive:u})})};pt(n.target,f=>(f&&a(f),()=>{f&&o(f)}))},Eo=n=>{const t={enabled:xe((n==null?void 0:n.enabled)??!0),pointer:xe(new wt),pointerOverTarget:xe(!1),lastEvent:void 0,raycaster:new zs,initialClick:[0,0],initialHits:[],hovered:new Map,interactiveObjects:[],target:xe((n==null?void 0:n.target)??pn().renderer.domElement),compute:()=>{},filter:n==null?void 0:n.filter};return t.compute=(n==null?void 0:n.compute)??go(t),Ft("threlte-interactivity-context",t),yo(),ko(t),t};function To(n){let t,l;return t=new Us({props:{position:n[1],rotation:n[2],scale:[1,n[3],1],color:n[0]}}),{c(){$(t.$$.fragment)},l(e){ee(t.$$.fragment,e)},m(e,s){te(t,e,s),l=!0},p(e,[s]){const i={};s&1&&(i.color=e[0]),t.$set(i)},i(e){l||(p(t.$$.fragment,e),l=!0)},o(e){S(t.$$.fragment,e),l=!1},d(e){ne(t,e)}}}function wo(n,t,l){let{from:e=[0,0,0]}=t,{to:s}=t,{offset:i=0}=t,{radius:r=.1}=t,{color:o="white"}=t;const a=new Be(...e),f=new Be(...s),{position:c,rotation:u,height:m}=_(a,f,i,r);function _(g,T,k,w){const j=T.clone().sub(g),z=j.length();let B;if(k===0)B=g.clone().add(j.multiplyScalar(.5)).toArray();else{const Y=new Be().crossVectors(j,new Be(1,0,0)).normalize();B=g.clone().add(j.multiplyScalar(.5)).add(Y.multiplyScalar(k*w*2)).toArray()}const I=new Rn().setFromUnitVectors(new Be(0,1,0),j.normalize()),H=new _i().setFromQuaternion(I).toArray();return{height:z,position:B,rotation:H}}return n.$$set=g=>{"from"in g&&l(4,e=g.from),"to"in g&&l(5,s=g.to),"offset"in g&&l(6,i=g.offset),"radius"in g&&l(7,r=g.radius),"color"in g&&l(0,o=g.color)},[o,c,u,m,e,s,i,r]}class Vn extends Ot{constructor(t){super(),Pt(this,t,wo,To,st,{from:4,to:5,offset:6,radius:7,color:0})}}function Vl(n,t,l){const e=n.slice();return e[9]=t[l],e[11]=l,e}function Ul(n,t,l){const e=n.slice();return e[9]=t[l],e[11]=l,e}function el(n){const t=n.slice(),l=new In().makeBasis(...t[0].map(s=>new Be(...s,0)));t[13]=l;const e=new di(1,1,1).applyMatrix4(t[13]);return t[14]=e,t}function Bl(n){let t,l;return t=new Ce.Mesh({props:{geometry:n[14],position:n[8],$$slots:{default:[So]},$$scope:{ctx:n}}}),{c(){$(t.$$.fragment)},l(e){ee(t.$$.fragment,e)},m(e,s){te(t,e,s),l=!0},p(e,s){const i={};s&1&&(i.geometry=e[14]),s&256&&(i.position=e[8]),s&32798&&(i.$$scope={dirty:s,ctx:e}),t.$set(i)},i(e){l||(p(t.$$.fragment,e),l=!0)},o(e){S(t.$$.fragment,e),l=!1},d(e){ne(t,e)}}}function So(n){let t,l;return t=new Ce.MeshBasicMaterial({props:{color:n[2],opacity:n[4],transparent:n[4]!==void 0,wireframe:n[1]==="wireframe",line_width:n[3]}}),{c(){$(t.$$.fragment)},l(e){ee(t.$$.fragment,e)},m(e,s){te(t,e,s),l=!0},p(e,s){const i={};s&4&&(i.color=e[2]),s&16&&(i.opacity=e[4]),s&16&&(i.transparent=e[4]!==void 0),s&2&&(i.wireframe=e[1]==="wireframe"),s&8&&(i.line_width=e[3]),t.$set(i)},i(e){l||(p(t.$$.fragment,e),l=!0)},o(e){S(t.$$.fragment,e),l=!1},d(e){ne(t,e)}}}function Hl(n){let t,l;return t=new Ce.Group({props:{position:n[7],$$slots:{default:[Po]},$$scope:{ctx:n}}}),{c(){$(t.$$.fragment)},l(e){ee(t.$$.fragment,e)},m(e,s){te(t,e,s),l=!0},p(e,s){const i={};s&128&&(i.position=e[7]),s&32833&&(i.$$scope={dirty:s,ctx:e}),t.$set(i)},i(e){l||(p(t.$$.fragment,e),l=!0)},o(e){S(t.$$.fragment,e),l=!1},d(e){ne(t,e)}}}function Kl(n){let t,l;return t=new Vn({props:{to:gn(n[9],.5),color:n[6][n[11]]}}),{c(){$(t.$$.fragment)},l(e){ee(t.$$.fragment,e)},m(e,s){te(t,e,s),l=!0},p(e,s){const i={};s&1&&(i.to=gn(e[9],.5)),s&64&&(i.color=e[6][e[11]]),t.$set(i)},i(e){l||(p(t.$$.fragment,e),l=!0)},o(e){S(t.$$.fragment,e),l=!1},d(e){ne(t,e)}}}function Co(n){let t,l,e,s,i,r;t=new Ce.CylinderGeometry({props:{args:[.1,.1,1,16]}}),e=new Ce.MeshStandardMaterial({});let o=lt(n[0]),a=[];for(let c=0;c<o.length;c+=1)a[c]=Kl(Ul(n,o,c));const f=c=>S(a[c],1,1,()=>{a[c]=null});return{c(){$(t.$$.fragment),l=D(),$(e.$$.fragment),s=D();for(let c=0;c<a.length;c+=1)a[c].c();i=_e()},l(c){ee(t.$$.fragment,c),l=V(c),ee(e.$$.fragment,c),s=V(c);for(let u=0;u<a.length;u+=1)a[u].l(c);i=_e()},m(c,u){te(t,c,u),O(c,l,u),te(e,c,u),O(c,s,u);for(let m=0;m<a.length;m+=1)a[m]&&a[m].m(c,u);O(c,i,u),r=!0},p(c,u){if(u&65){o=lt(c[0]);let m;for(m=0;m<o.length;m+=1){const _=Ul(c,o,m);a[m]?(a[m].p(_,u),p(a[m],1)):(a[m]=Kl(_),a[m].c(),p(a[m],1),a[m].m(i.parentNode,i))}for(we(),m=o.length;m<a.length;m+=1)f(m);Se()}},i(c){if(!r){p(t.$$.fragment,c),p(e.$$.fragment,c);for(let u=0;u<o.length;u+=1)p(a[u]);r=!0}},o(c){S(t.$$.fragment,c),S(e.$$.fragment,c),a=a.filter(Boolean);for(let u=0;u<a.length;u+=1)S(a[u]);r=!1},d(c){c&&(b(l),b(s),b(i)),ne(t,c),ne(e,c),Qt(a,c)}}}function Yl(n){let t,l;return t=new Vn({props:{to:n[9],color:n[6][n[11]]}}),{c(){$(t.$$.fragment)},l(e){ee(t.$$.fragment,e)},m(e,s){te(t,e,s),l=!0},p(e,s){const i={};s&1&&(i.to=e[9]),s&64&&(i.color=e[6][e[11]]),t.$set(i)},i(e){l||(p(t.$$.fragment,e),l=!0)},o(e){S(t.$$.fragment,e),l=!1},d(e){ne(t,e)}}}function Oo(n){let t,l,e,s,i,r;t=new Ce.MeshStandardMaterial({}),e=new Ce.ConeGeometry({props:{args:[.25,.12,32]}});let o=lt(n[0]),a=[];for(let c=0;c<o.length;c+=1)a[c]=Yl(Vl(n,o,c));const f=c=>S(a[c],1,1,()=>{a[c]=null});return{c(){$(t.$$.fragment),l=D(),$(e.$$.fragment),s=D();for(let c=0;c<a.length;c+=1)a[c].c();i=_e()},l(c){ee(t.$$.fragment,c),l=V(c),ee(e.$$.fragment,c),s=V(c);for(let u=0;u<a.length;u+=1)a[u].l(c);i=_e()},m(c,u){te(t,c,u),O(c,l,u),te(e,c,u),O(c,s,u);for(let m=0;m<a.length;m+=1)a[m]&&a[m].m(c,u);O(c,i,u),r=!0},p(c,u){if(u&65){o=lt(c[0]);let m;for(m=0;m<o.length;m+=1){const _=Vl(c,o,m);a[m]?(a[m].p(_,u),p(a[m],1)):(a[m]=Yl(_),a[m].c(),p(a[m],1),a[m].m(i.parentNode,i))}for(we(),m=o.length;m<a.length;m+=1)f(m);Se()}},i(c){if(!r){p(t.$$.fragment,c),p(e.$$.fragment,c);for(let u=0;u<o.length;u+=1)p(a[u]);r=!0}},o(c){S(t.$$.fragment,c),S(e.$$.fragment,c),a=a.filter(Boolean);for(let u=0;u<a.length;u+=1)S(a[u]);r=!1},d(c){c&&(b(l),b(s),b(i)),ne(t,c),ne(e,c),Qt(a,c)}}}function Po(n){let t,l,e,s;return t=new bn({props:{$$slots:{default:[Co]},$$scope:{ctx:n}}}),e=new bn({props:{$$slots:{default:[Oo]},$$scope:{ctx:n}}}),{c(){$(t.$$.fragment),l=D(),$(e.$$.fragment)},l(i){ee(t.$$.fragment,i),l=V(i),ee(e.$$.fragment,i)},m(i,r){te(t,i,r),O(i,l,r),te(e,i,r),s=!0},p(i,r){const o={};r&32833&&(o.$$scope={dirty:r,ctx:i}),t.$set(o);const a={};r&32833&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){s||(p(t.$$.fragment,i),p(e.$$.fragment,i),s=!0)},o(i){S(t.$$.fragment,i),S(e.$$.fragment,i),s=!1},d(i){i&&b(l),ne(t,i),ne(e,i)}}}function Fl(n){let t,l,e,s=n[1]&&Bl(el(n)),i=n[5]&&Hl(n);return{c(){s&&s.c(),t=D(),i&&i.c(),l=_e()},l(r){s&&s.l(r),t=V(r),i&&i.l(r),l=_e()},m(r,o){s&&s.m(r,o),O(r,t,o),i&&i.m(r,o),O(r,l,o),e=!0},p(r,o){r[1]?s?(s.p(el(r),o),o&2&&p(s,1)):(s=Bl(el(r)),s.c(),p(s,1),s.m(t.parentNode,t)):s&&(we(),S(s,1,1,()=>{s=null}),Se()),r[5]?i?(i.p(r,o),o&32&&p(i,1)):(i=Hl(r),i.c(),p(i,1),i.m(l.parentNode,l)):i&&(we(),S(i,1,1,()=>{i=null}),Se())},i(r){e||(p(s),p(i),e=!0)},o(r){S(s),S(i),e=!1},d(r){r&&(b(t),b(l)),s&&s.d(r),i&&i.d(r)}}}function Mo(n){let t=n[0],l,e,s=Fl(n);return{c(){s.c(),l=_e()},l(i){s.l(i),l=_e()},m(i,r){s.m(i,r),O(i,l,r),e=!0},p(i,[r]){r&1&&st(t,t=i[0])?(we(),S(s,1,1,Vt),Se(),s=Fl(i),s.c(),p(s,1),s.m(l.parentNode,l)):s.p(i,r)},i(i){e||(p(s),e=!0)},o(i){S(s),e=!1},d(i){i&&b(l),s.d(i)}}}function Io(n,t,l){let e,{matrix:s}=t,{show_cell:i="wireframe"}=t,{cell_color:r="white"}=t,{cell_line_width:o=1}=t,{cell_opacity:a=1}=t,{show_vectors:f=!0}=t,{vector_colors:c=["red","green","blue"]}=t,{vector_origin:u=[-1,-1,-1]}=t;return n.$$set=m=>{"matrix"in m&&l(0,s=m.matrix),"show_cell"in m&&l(1,i=m.show_cell),"cell_color"in m&&l(2,r=m.cell_color),"cell_line_width"in m&&l(3,o=m.cell_line_width),"cell_opacity"in m&&l(4,a=m.cell_opacity),"show_vectors"in m&&l(5,f=m.show_vectors),"vector_colors"in m&&l(6,c=m.vector_colors),"vector_origin"in m&&l(7,u=m.vector_origin)},n.$$.update=()=>{n.$$.dirty&1&&l(8,e=gn(il(...s),.5))},[s,i,r,o,a,f,c,u,e]}class Lo extends Ot{constructor(t){super(),Pt(this,t,Io,Mo,st,{matrix:0,show_cell:1,cell_color:2,cell_line_width:3,cell_opacity:4,show_vectors:5,vector_colors:6,vector_origin:7})}}const No=n=>({}),Zl=n=>({}),zo=n=>({}),Wl=n=>({}),Ao=n=>({}),Gl=n=>({});function Ro(n){let t,l;const e=n[9].default,s=Fe(e,n,n[8],null),i=n[9].trigger,r=Fe(i,n,n[8],Zl);return{c(){s&&s.c(),t=D(),r&&r.c()},l(o){s&&s.l(o),t=V(o),r&&r.l(o)},m(o,a){s&&s.m(o,a),O(o,t,a),r&&r.m(o,a),l=!0},p(o,a){s&&s.p&&(!l||a&256)&&Ze(s,e,o,o[8],l?Ge(e,o[8],a,null):We(o[8]),null),r&&r.p&&(!l||a&256)&&Ze(r,i,o,o[8],l?Ge(i,o[8],a,No):We(o[8]),Zl)},i(o){l||(p(s,o),p(r,o),l=!0)},o(o){S(s,o),S(r,o),l=!1},d(o){o&&b(t),s&&s.d(o),r&&r.d(o)}}}function jo(n){let t,l,e,s,i;const r=n[9].default,o=Fe(r,n,n[8],null),a=n[9].trigger,f=Fe(a,n,n[8],Gl),c=n[9].tip,u=Fe(c,n,n[8],Wl),m=u||Do(n);return{c(){t=P("span"),o&&o.c(),l=D(),f&&f.c(),e=D(),s=P("div"),m&&m.c(),this.h()},l(_){t=M(_,"SPAN",{style:!0,class:!0});var g=q(t);o&&o.l(g),l=V(g),f&&f.l(g),e=V(g),s=M(g,"DIV",{style:!0,class:!0});var T=q(s);m&&m.l(T),T.forEach(b),g.forEach(b),this.h()},h(){h(s,"style",n[6]),h(s,"class","svelte-tz3i9m"),He(s,"min-width",n[2]),He(s,"max-width",n[1]),He(s,"background",n[3]),h(t,"style",n[5]),h(t,"class","svelte-tz3i9m"),He(t,"cursor",n[4])},m(_,g){O(_,t,g),o&&o.m(t,null),y(t,l),f&&f.m(t,null),y(t,e),y(t,s),m&&m.m(s,null),i=!0},p(_,g){o&&o.p&&(!i||g&256)&&Ze(o,r,_,_[8],i?Ge(r,_[8],g,null):We(_[8]),null),f&&f.p&&(!i||g&256)&&Ze(f,a,_,_[8],i?Ge(a,_[8],g,Ao):We(_[8]),Gl),u?u.p&&(!i||g&256)&&Ze(u,c,_,_[8],i?Ge(c,_[8],g,zo):We(_[8]),Wl):m&&m.p&&(!i||g&1)&&m.p(_,i?g:-1),(!i||g&64)&&h(s,"style",_[6]);const T=g&64;(g&68||T)&&He(s,"min-width",_[2]),(g&66||T)&&He(s,"max-width",_[1]),(g&72||T)&&He(s,"background",_[3]),(!i||g&32)&&h(t,"style",_[5]);const k=g&32;(g&48||k)&&He(t,"cursor",_[4])},i(_){i||(p(o,_),p(f,_),p(m,_),i=!0)},o(_){S(o,_),S(f,_),S(m,_),i=!1},d(_){_&&b(t),o&&o.d(_),f&&f.d(_),m&&m.d(_)}}}function Do(n){let t;return{c(){t=oe(n[0])},l(l){t=ae(l,n[0])},m(l,e){O(l,t,e)},p(l,e){e&1&&St(t,l[0])},d(l){l&&b(t)}}}function Vo(n){let t,l,e,s;const i=[jo,Ro],r=[];function o(a,f){return a[7].tip||a[0]?0:1}return t=o(n),l=r[t]=i[t](n),{c(){l.c(),e=_e()},l(a){l.l(a),e=_e()},m(a,f){r[t].m(a,f),O(a,e,f),s=!0},p(a,[f]){let c=t;t=o(a),t===c?r[t].p(a,f):(we(),S(r[c],1,1,()=>{r[c]=null}),Se(),l=r[t],l?l.p(a,f):(l=r[t]=i[t](a),l.c()),p(l,1),l.m(e.parentNode,e))},i(a){s||(p(l),s=!0)},o(a){S(l),s=!1},d(a){a&&b(e),r[t].d(a)}}}function Uo(n,t,l){let{$$slots:e={},$$scope:s}=t;const i=Ms(e);let{text:r=null}=t,{max_width:o="14em"}=t,{min_width:a="max-content"}=t,{bg:f=null}=t,{cursor:c=null}=t,{style:u=null}=t,{tip_style:m=null}=t;return n.$$set=_=>{"text"in _&&l(0,r=_.text),"max_width"in _&&l(1,o=_.max_width),"min_width"in _&&l(2,a=_.min_width),"bg"in _&&l(3,f=_.bg),"cursor"in _&&l(4,c=_.cursor),"style"in _&&l(5,u=_.style),"tip_style"in _&&l(6,m=_.tip_style),"$$scope"in _&&l(8,s=_.$$scope)},n.$$.update=()=>{n.$$.dirty&1&&r&&i.tip&&console.error("svelte-zoo tooltip: both text prop and slot='tip' were passed, only one is allowed")},[r,o,a,f,c,u,m,i,s,e]}class dn extends Ot{constructor(t){super(),Pt(this,t,Uo,Vo,st,{text:0,max_width:1,min_width:2,bg:3,cursor:4,style:5,tip_style:6})}}const Bo=n=>({}),Xl=n=>({});function ql(n,t,l){const e=n.slice();return e[14]=t[l][0],e[15]=t[l][1],e[16]=t,e[17]=l,e}function Ho(n){let t,l=n[14]+"",e,s=n[15]+"",i,r,o,a=n[17],f,c,u;function m(){n[8].call(o,n[14])}const _=()=>n[9](t,a),g=()=>n[9](null,a);function T(){return n[10](n[14])}return{c(){t=P("label"),e=oe(l),i=oe(s),r=D(),o=P("input"),f=D(),this.h()},l(k){t=M(k,"LABEL",{style:!0,class:!0});var w=q(t);e=ae(w,l),i=ae(w,s),r=V(w),o=M(w,"INPUT",{type:!0,title:!0,class:!0}),w.forEach(b),f=V(k),this.h()},h(){h(o,"type","color"),h(o,"title",n[3]),h(o,"class","svelte-5q6gcr"),He(t,"background-color",n[6][n[14]]),h(t,"class","svelte-5q6gcr"),He(t,"color",El(n[0][n[17]]))},m(k,w){O(k,t,w),y(t,e),y(t,i),y(t,r),y(t,o),x(o,n[6][n[14]]),_(),O(k,f,w),c||(u=[X(o,"input",m),X(t,"dblclick",Mn(T))],c=!0)},p(k,w){n=k,w&4&&l!==(l=n[14]+"")&&St(e,l),w&4&&s!==(s=n[15]+"")&&St(i,s),w&8&&h(o,"title",n[3]),w&68&&x(o,n[6][n[14]]),w&68&&He(t,"background-color",n[6][n[14]]),a!==n[17]&&(g(),a=n[17],_());const j=w&68;(w&69||j)&&He(t,"color",El(n[0][n[17]]))},d(k){k&&(b(t),b(f)),g(),c=!1,qt(u)}}}function Ql(n){var i;let t,l,e;function s(...r){return n[11](n[14],...r)}return t=new dn({props:{text:(i=kl.find(s))==null?void 0:i.name,tip_style:"font-size: initial; padding: 0 5pt;",$$slots:{default:[Ho]},$$scope:{ctx:n}}}),{c(){l=P("div"),$(t.$$.fragment),this.h()},l(r){l=M(r,"DIV",{style:!0});var o=q(l);ee(t.$$.fragment,o),this.h()},h(){He(l,"display","contents"),He(l,"--zoo-tooltip-bg","rgba(255, 255, 255, 0.3)")},m(r,o){O(r,l,o),te(t,l,null),e=!0},p(r,o){var f;n=r;const a={};o&4&&(a.text=(f=kl.find(s))==null?void 0:f.name),o&8269&&(a.$$scope={dirty:o,ctx:n}),t.$set(a)},i(r){e||(p(t.$$.fragment,r),e=!0)},o(r){S(t.$$.fragment,r),e=!1},d(r){r&&t&&b(l),ne(t,r)}}}function Ko(n){let t,l="Drop a JSON file onto the canvas to load a new structure.",e,s,i=`Click on an atom to make it active. Then hover another atom to get its distance to
      the active atom.`,r,o,a="Hold <kbd>shift</kbd> or <kbd>cmd</kbd> or <kbd>ctrl</kbd> and drag to pan the scene.";return{c(){t=P("p"),t.textContent=l,e=D(),s=P("p"),s.textContent=i,r=D(),o=P("p"),o.innerHTML=a,this.h()},l(f){t=M(f,"P",{class:!0,"data-svelte-h":!0}),_t(t)!=="svelte-q5xbhi"&&(t.textContent=l),e=V(f),s=M(f,"P",{class:!0,"data-svelte-h":!0}),_t(s)!=="svelte-1i18ykt"&&(s.textContent=i),r=V(f),o=M(f,"P",{class:!0,"data-svelte-h":!0}),_t(o)!=="svelte-4yi1h9"&&(o.innerHTML=a),this.h()},h(){h(t,"class","svelte-5q6gcr"),h(s,"class","svelte-5q6gcr"),h(o,"class","svelte-5q6gcr")},m(f,c){O(f,t,c),O(f,e,c),O(f,s,c),O(f,r,c),O(f,o,c)},p:Vt,d(f){f&&(b(t),b(e),b(s),b(r),b(o))}}}function Yo(n){let t,l,e,s,i,r,o=lt(Object.entries(n[2])),a=[];for(let _=0;_<o.length;_+=1)a[_]=Ql(ql(n,o,_));const f=_=>S(a[_],1,1,()=>{a[_]=null}),c=n[7]["tips-modal"],u=Fe(c,n,n[13],Xl),m=u||Ko();return{c(){t=P("div");for(let _=0;_<a.length;_+=1)a[_].c();l=D(),e=P("dialog"),m&&m.c(),this.h()},l(_){t=M(_,"DIV",{style:!0,class:!0});var g=q(t);for(let k=0;k<a.length;k+=1)a[k].l(g);g.forEach(b),l=V(_),e=M(_,"DIALOG",{role:!0,style:!0,class:!0});var T=q(e);m&&m.l(T),T.forEach(b),this.h()},h(){h(t,"style",n[4]),h(t,"class","svelte-5q6gcr"),h(e,"role","tooltip"),h(e,"style",n[5]),h(e,"class","svelte-5q6gcr")},m(_,g){O(_,t,g);for(let T=0;T<a.length;T+=1)a[T]&&a[T].m(t,null);O(_,l,g),O(_,e,g),m&&m.m(e,null),n[12](e),s=!0,i||(r=[X(e,"click",function(){var T,k;sl((T=n[1])==null?void 0:T.close)&&((k=n[1])==null||k.close.apply(this,arguments))}),X(e,"keydown",function(){var T,k;sl((T=n[1])==null?void 0:T.close)&&((k=n[1])==null||k.close.apply(this,arguments))})],i=!0)},p(_,[g]){if(n=_,g&77){o=lt(Object.entries(n[2]));let T;for(T=0;T<o.length;T+=1){const k=ql(n,o,T);a[T]?(a[T].p(k,g),p(a[T],1)):(a[T]=Ql(k),a[T].c(),p(a[T],1),a[T].m(t,null))}for(we(),T=o.length;T<a.length;T+=1)f(T);Se()}(!s||g&16)&&h(t,"style",n[4]),u&&u.p&&(!s||g&8192)&&Ze(u,c,n,n[13],s?Ge(c,n[13],g,Bo):We(n[13]),Xl),(!s||g&32)&&h(e,"style",n[5])},i(_){if(!s){for(let g=0;g<o.length;g+=1)p(a[g]);p(m,_),s=!0}},o(_){a=a.filter(Boolean);for(let g=0;g<a.length;g+=1)S(a[g]);S(m,_),s=!1},d(_){_&&(b(t),b(l),b(e)),Qt(a,_),m&&m.d(_),n[12](null),i=!1,qt(r)}}}function Fo(n,t,l){let e;Qe(n,ln,w=>l(6,e=w));let{$$slots:s={},$$scope:i}=t,{elements:r}=t,{elem_color_picker_title:o="Double click to reset color"}=t,{labels:a=[]}=t,{tips_modal:f=void 0}=t,{style:c=null}=t,{dialog_style:u=null}=t;function m(w){e[w]=this.value,ln.set(e)}function _(w,j){$e[w?"unshift":"push"](()=>{a[j]=w,l(0,a)})}const g=w=>{Is(ln,e[w]=hi[w],e)},T=(w,j)=>j.symbol==w;function k(w){$e[w?"unshift":"push"](()=>{f=w,l(1,f)})}return n.$$set=w=>{"elements"in w&&l(2,r=w.elements),"elem_color_picker_title"in w&&l(3,o=w.elem_color_picker_title),"labels"in w&&l(0,a=w.labels),"tips_modal"in w&&l(1,f=w.tips_modal),"style"in w&&l(4,c=w.style),"dialog_style"in w&&l(5,u=w.dialog_style),"$$scope"in w&&l(13,i=w.$$scope)},[a,f,r,o,c,u,e,s,m,_,g,T,k,i]}class Zo extends Ot{constructor(t){super(),Pt(this,t,Fo,Yo,st,{elements:2,elem_color_picker_title:3,labels:0,tips_modal:1,style:4,dialog_style:5})}}function Wo(n,{max_bond_dist:t=3,min_bond_dist:l=.4}={}){const e=[],s=new Set;for(let i=0;i<n.sites.length;i++){const{xyz:r}=n.sites[i];for(let o=i+1;o<n.sites.length;o++){const{xyz:a}=n.sites[o],f=jn(r,a);if(f<t&&f>l){const c=[r,a].sort().toString();s.has(c)||(s.add(c),e.push([r,a,i,o,f]))}}}return e}function Go(n,{scaling_factor:t=1.2,min_bond_dist:l=.1}={}){const e=n.sites.length,s=[],i=new Set;for(let r=0;r<e;r++){const{xyz:o}=n.sites[r];let a=1/0;for(let f=r+1;f<e;f++){const{xyz:c}=n.sites[f],u=jn(o,c);u>l&&u<a&&(a=u)}for(let f=r+1;f<e;f++){const{xyz:c}=n.sites[f],u=jn(o,c);if(u<=a*t){const m=[o,c].sort().toString();i.has(m)||(i.add(m),s.push([o,c,r,f,u]))}}}return s}const Xo=Object.freeze(Object.defineProperty({__proto__:null,max_dist:Wo,nearest_neighbor:Go},Symbol.toStringTag,{value:"Module"})),{Boolean:ul}=bi;function tl(n){const t=n.slice(),l=jn(t[2].xyz,t[3].xyz);return t[37]=l,t}function Jl(n,t,l){const e=n.slice();e[38]=t[l].element,e[39]=t[l].occu,e[40]=t[l].oxidation_state;const s=e[40]&&Math.abs(e[40])+(e[40]>0?"+":"-");return e[41]=s,e}function nl(n){const t=n.slice(),l=t[19];return t[44]=l.color,t[45]=l.width,t[46]=l.opacity,t}function xl(n,t,l){const e=n.slice();return e[47]=t[l].site,e[46]=t[l].opacity,e}function ll(n){const t=n.slice(),l=t[47];t[50]=l.xyz,t[51]=l.species;const e=t[51][0].element;t[52]=e;const s=1.1*(t[6]?1:As[t[52]])*t[5];return t[53]=s,t}function $l(n,t,l){const e=n.slice();return e[54]=t[l][0],e[55]=t[l][1],e}function es(n,t,l){const e=n.slice();e[47]=t[l],e[59]=l;const s=e[47];e[51]=s.species,e[50]=s.xyz;const i=e[51][0].element;e[52]=i;const r=(e[6]?1:As[e[52]])*e[5];return e[53]=r,e}const qo=n=>({elem:n[0]&16,xyz:n[0]&16,species:n[0]&16}),ts=n=>({elem:n[52],xyz:n[50],species:n[51]});function Qo(n){var e,s,i;let t,l;return t=new $i({props:{enableZoom:n[11]>0,zoomSpeed:n[11],enablePan:n[12]>0,panSpeed:n[12],target:(e=n[4])!=null&&e.lattice?gn(il(...((i=(s=n[4])==null?void 0:s.lattice)==null?void 0:i.matrix)??[]),.5):[0,0,0],maxZoom:n[9],minZoom:n[10],autoRotate:!!n[16],autoRotateSpeed:n[16],enableDamping:!!n[8],dampingFactor:n[8]}}),{c(){$(t.$$.fragment)},l(r){ee(t.$$.fragment,r)},m(r,o){te(t,r,o),l=!0},p(r,o){var f,c,u;const a={};o[0]&2048&&(a.enableZoom=r[11]>0),o[0]&2048&&(a.zoomSpeed=r[11]),o[0]&4096&&(a.enablePan=r[12]>0),o[0]&4096&&(a.panSpeed=r[12]),o[0]&16&&(a.target=(f=r[4])!=null&&f.lattice?gn(il(...((u=(c=r[4])==null?void 0:c.lattice)==null?void 0:u.matrix)??[]),.5):[0,0,0]),o[0]&512&&(a.maxZoom=r[9]),o[0]&1024&&(a.minZoom=r[10]),o[0]&65536&&(a.autoRotate=!!r[16]),o[0]&65536&&(a.autoRotateSpeed=r[16]),o[0]&256&&(a.enableDamping=!!r[8]),o[0]&256&&(a.dampingFactor=r[8]),t.$set(a)},i(r){l||(p(t.$$.fragment,r),l=!0)},o(r){S(t.$$.fragment,r),l=!1},d(r){ne(t,r)}}}function ns(n){let t,l;return t=new bn({props:{$$slots:{default:[xo]},$$scope:{ctx:n}}}),{c(){$(t.$$.fragment)},l(e){ee(t.$$.fragment,e)},m(e,s){te(t,e,s),l=!0},p(e,s){const i={};s[0]&100663411|s[1]&32&&(i.$$scope={dirty:s,ctx:e}),t.$set(i)},i(e){l||(p(t.$$.fragment,e),l=!0)},o(e){S(t.$$.fragment,e),l=!1},d(e){ne(t,e)}}}function ls(n){let t,l;return t=new Ds({props:{center:!0,position:n[50],$$slots:{default:[Jo]},$$scope:{ctx:n}}}),{c(){$(t.$$.fragment)},l(e){ee(t.$$.fragment,e)},m(e,s){te(t,e,s),l=!0},p(e,s){const i={};s[0]&16&&(i.position=e[50]),s[0]&16|s[1]&32&&(i.$$scope={dirty:s,ctx:e}),t.$set(i)},i(e){l||(p(t.$$.fragment,e),l=!0)},o(e){S(t.$$.fragment,e),l=!1},d(e){ne(t,e)}}}function Jo(n){let t,l;const e=n[31]["atom-label"],s=Fe(e,n,n[36],ts);return{c(){s&&s.c(),t=D()},l(i){s&&s.l(i),t=V(i)},m(i,r){s&&s.m(i,r),O(i,t,r),l=!0},p(i,r){s&&s.p&&(!l||r[0]&16|r[1]&32)&&Ze(s,e,i,i[36],l?Ge(e,i[36],r,qo):We(i[36]),ts)},i(i){l||(p(s,i),l=!0)},o(i){S(s,i),l=!1},d(i){i&&b(t),s&&s.d(i)}}}function ss(n){let t,l,e,s;function i(){return n[32](n[59])}function r(){return n[34](n[59])}t=new Us({props:{position:n[50],color:n[25][n[51][0].element],scale:n[53]}}),t.$on("pointerenter",i),t.$on("pointerleave",n[33]),t.$on("click",r);let o=n[26]["atom-label"]&&ls(n);return{c(){$(t.$$.fragment),l=D(),o&&o.c(),e=_e()},l(a){ee(t.$$.fragment,a),l=V(a),o&&o.l(a),e=_e()},m(a,f){te(t,a,f),O(a,l,f),o&&o.m(a,f),O(a,e,f),s=!0},p(a,f){n=a;const c={};f[0]&16&&(c.position=n[50]),f[0]&33554448&&(c.color=n[25][n[51][0].element]),f[0]&112&&(c.scale=n[53]),t.$set(c),n[26]["atom-label"]?o?(o.p(n,f),f[0]&67108864&&p(o,1)):(o=ls(n),o.c(),p(o,1),o.m(e.parentNode,e)):o&&(we(),S(o,1,1,()=>{o=null}),Se())},i(a){s||(p(t.$$.fragment,a),p(o),s=!0)},o(a){S(t.$$.fragment,a),S(o),s=!1},d(a){a&&(b(l),b(e)),ne(t,a),o&&o.d(a)}}}function xo(n){let t,l,e,s,i,r;t=new Ce.MeshStandardMaterial({}),e=new Ce.SphereGeometry({props:{args:[1,20,20]}});let o=lt(n[4].sites),a=[];for(let c=0;c<o.length;c+=1)a[c]=ss(es(n,o,c));const f=c=>S(a[c],1,1,()=>{a[c]=null});return{c(){$(t.$$.fragment),l=D(),$(e.$$.fragment),s=D();for(let c=0;c<a.length;c+=1)a[c].c();i=_e()},l(c){ee(t.$$.fragment,c),l=V(c),ee(e.$$.fragment,c),s=V(c);for(let u=0;u<a.length;u+=1)a[u].l(c);i=_e()},m(c,u){te(t,c,u),O(c,l,u),te(e,c,u),O(c,s,u);for(let m=0;m<a.length;m+=1)a[m]&&a[m].m(c,u);O(c,i,u),r=!0},p(c,u){if(u[0]&100663411|u[1]&32){o=lt(c[4].sites);let m;for(m=0;m<o.length;m+=1){const _=es(c,o,m);a[m]?(a[m].p(_,u),p(a[m],1)):(a[m]=ss(_),a[m].c(),p(a[m],1),a[m].m(i.parentNode,i))}for(we(),m=o.length;m<a.length;m+=1)f(m);Se()}},i(c){if(!r){p(t.$$.fragment,c),p(e.$$.fragment,c);for(let u=0;u<o.length;u+=1)p(a[u]);r=!0}},o(c){S(t.$$.fragment,c),S(e.$$.fragment,c),a=a.filter(ul);for(let u=0;u<a.length;u+=1)S(a[u]);r=!1},d(c){c&&(b(l),b(s),b(i)),ne(t,c),ne(e,c),Qt(a,c)}}}function is(n){let t,l;return t=new bn({props:{$$slots:{default:[$o]},$$scope:{ctx:n}}}),{c(){$(t.$$.fragment)},l(e){ee(t.$$.fragment,e)},m(e,s){te(t,e,s),l=!0},p(e,s){const i={};s[0]&25559040|s[1]&32&&(i.$$scope={dirty:s,ctx:e}),t.$set(i)},i(e){l||(p(t.$$.fragment,e),l=!0)},o(e){S(t.$$.fragment,e),l=!1},d(e){ne(t,e)}}}function os(n){let t,l;return t=new Vn({props:{from:n[54],to:n[55],radius:1}}),{c(){$(t.$$.fragment)},l(e){ee(t.$$.fragment,e)},m(e,s){te(t,e,s),l=!0},p(e,s){const i={};s[0]&8388608&&(i.from=e[54]),s[0]&8388608&&(i.to=e[55]),t.$set(i)},i(e){l||(p(t.$$.fragment,e),l=!0)},o(e){S(t.$$.fragment,e),l=!1},d(e){ne(t,e)}}}function as(n){let t,l,e=lt(n[23]??[]),s=[];for(let r=0;r<e.length;r+=1)s[r]=os($l(n,e,r));const i=r=>S(s[r],1,1,()=>{s[r]=null});return{c(){for(let r=0;r<s.length;r+=1)s[r].c();t=_e()},l(r){for(let o=0;o<s.length;o+=1)s[o].l(r);t=_e()},m(r,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(r,o);O(r,t,o),l=!0},p(r,o){if(o[0]&8388608){e=lt(r[23]??[]);let a;for(a=0;a<e.length;a+=1){const f=$l(r,e,a);s[a]?(s[a].p(f,o),p(s[a],1)):(s[a]=os(f),s[a].c(),p(s[a],1),s[a].m(t.parentNode,t))}for(we(),a=e.length;a<s.length;a+=1)i(a);Se()}},i(r){if(!l){for(let o=0;o<e.length;o+=1)p(s[o]);l=!0}},o(r){s=s.filter(ul);for(let o=0;o<s.length;o+=1)S(s[o]);l=!1},d(r){r&&b(t),Qt(s,r)}}}function $o(n){let t,l,e,s,i=n[23],r,o;t=new Ce.CylinderGeometry({props:{args:[n[24],n[24],1,16]}}),e=new Ce.MeshStandardMaterial({props:{opacity:n[17],color:n[18]}});let a=as(n);return{c(){$(t.$$.fragment),l=D(),$(e.$$.fragment),s=D(),a.c(),r=_e()},l(f){ee(t.$$.fragment,f),l=V(f),ee(e.$$.fragment,f),s=V(f),a.l(f),r=_e()},m(f,c){te(t,f,c),O(f,l,c),te(e,f,c),O(f,s,c),a.m(f,c),O(f,r,c),o=!0},p(f,c){const u={};c[0]&16777216&&(u.args=[f[24],f[24],1,16]),t.$set(u);const m={};c[0]&131072&&(m.opacity=f[17]),c[0]&262144&&(m.color=f[18]),e.$set(m),c[0]&8388608&&st(i,i=f[23])?(we(),S(a,1,1,Vt),Se(),a=as(f),a.c(),p(a,1),a.m(r.parentNode,r)):a.p(f,c)},i(f){o||(p(t.$$.fragment,f),p(e.$$.fragment,f),p(a),o=!0)},o(f){S(t.$$.fragment,f),S(e.$$.fragment,f),S(a),o=!1},d(f){f&&(b(l),b(s),b(r)),ne(t,f),ne(e,f),a.d(f)}}}function rs(n){let t,l;return t=new Ce.Mesh({props:{position:n[50],$$slots:{default:[ea]},$$scope:{ctx:n}}}),{c(){$(t.$$.fragment)},l(e){ee(t.$$.fragment,e)},m(e,s){te(t,e,s),l=!0},p(e,s){const i={};s[0]&12&&(i.position=e[50]),s[0]&108|s[1]&32&&(i.$$scope={dirty:s,ctx:e}),t.$set(i)},i(e){l||(p(t.$$.fragment,e),l=!0)},o(e){S(t.$$.fragment,e),l=!1},d(e){ne(t,e)}}}function ea(n){let t,l,e,s,i;return t=new Ce.SphereGeometry({props:{args:[n[53],20,20]}}),e=new Ce.MeshStandardMaterial({props:{color:"white",transparent:!0,opacity:n[46]}}),{c(){$(t.$$.fragment),l=D(),$(e.$$.fragment),s=D()},l(r){ee(t.$$.fragment,r),l=V(r),ee(e.$$.fragment,r),s=V(r)},m(r,o){te(t,r,o),O(r,l,o),te(e,r,o),O(r,s,o),i=!0},p(r,o){const a={};o[0]&108&&(a.args=[r[53],20,20]),t.$set(a);const f={};o[0]&12&&(f.opacity=r[46]),e.$set(f)},i(r){i||(p(t.$$.fragment,r),p(e.$$.fragment,r),i=!0)},o(r){S(t.$$.fragment,r),S(e.$$.fragment,r),i=!1},d(r){r&&(b(l),b(s)),ne(t,r),ne(e,r)}}}function cs(n){let t,l,e=n[47]&&rs(ll(n));return{c(){e&&e.c(),t=_e()},l(s){e&&e.l(s),t=_e()},m(s,i){e&&e.m(s,i),O(s,t,i),l=!0},p(s,i){s[47]?e?(e.p(ll(s),i),i[0]&12&&p(e,1)):(e=rs(ll(s)),e.c(),p(e,1),e.m(t.parentNode,t)):e&&(we(),S(e,1,1,()=>{e=null}),Se())},i(s){l||(p(e),l=!0)},o(s){S(e),l=!1},d(s){s&&b(t),e&&e.d(s)}}}function fs(n){let t,l;return t=new bn({props:{$$slots:{default:[ta]},$$scope:{ctx:n}}}),{c(){$(t.$$.fragment)},l(e){ee(t.$$.fragment,e)},m(e,s){te(t,e,s),l=!0},p(e,s){const i={};s[0]&524300|s[1]&32&&(i.$$scope={dirty:s,ctx:e}),t.$set(i)},i(e){l||(p(t.$$.fragment,e),l=!0)},o(e){S(t.$$.fragment,e),l=!1},d(e){ne(t,e)}}}function ta(n){let t,l,e,s,i,r;return t=new Ce.CylinderGeometry({props:{args:[n[45],n[45],1,16]}}),e=new Ce.MeshStandardMaterial({props:{opacity:n[46],color:n[44]}}),i=new Vn({props:{from:n[3].xyz,to:n[2].xyz,radius:1}}),{c(){$(t.$$.fragment),l=D(),$(e.$$.fragment),s=D(),$(i.$$.fragment)},l(o){ee(t.$$.fragment,o),l=V(o),ee(e.$$.fragment,o),s=V(o),ee(i.$$.fragment,o)},m(o,a){te(t,o,a),O(o,l,a),te(e,o,a),O(o,s,a),te(i,o,a),r=!0},p(o,a){const f={};a[0]&524288&&(f.args=[o[45],o[45],1,16]),t.$set(f);const c={};a[0]&524288&&(c.opacity=o[46]),a[0]&524288&&(c.color=o[44]),e.$set(c);const u={};a[0]&8&&(u.from=o[3].xyz),a[0]&4&&(u.to=o[2].xyz),i.$set(u)},i(o){r||(p(t.$$.fragment,o),p(e.$$.fragment,o),p(i.$$.fragment,o),r=!0)},o(o){S(t.$$.fragment,o),S(e.$$.fragment,o),S(i.$$.fragment,o),r=!1},d(o){o&&(b(l),b(s)),ne(t,o),ne(e,o),ne(i,o)}}}function us(n){let t,l;return t=new Ds({props:{position:n[2].xyz,pointerEvents:"none",$$slots:{default:[na]},$$scope:{ctx:n}}}),{c(){$(t.$$.fragment)},l(e){ee(t.$$.fragment,e)},m(e,s){te(t,e,s),l=!0},p(e,s){const i={};s[0]&4&&(i.position=e[2].xyz),s[0]&557068|s[1]&32&&(i.$$scope={dirty:s,ctx:e}),t.$set(i)},i(e){l||(p(t.$$.fragment,e),l=!0)},o(e){S(t.$$.fragment,e),l=!1},d(e){ne(t,e)}}}function ms(n){let t,l=n[38]+"",e,s=(n[41]??"")+"",i,r,o=n[39]==1?"":`(occu=${n[39]})`,a;return{c(){t=P("strong"),e=oe(l),i=oe(s),r=D(),a=oe(o)},l(f){t=M(f,"STRONG",{});var c=q(t);e=ae(c,l),i=ae(c,s),c.forEach(b),r=V(f),a=ae(f,o)},m(f,c){O(f,t,c),y(t,e),y(t,i),O(f,r,c),O(f,a,c)},p(f,c){c[0]&4&&l!==(l=f[38]+"")&&St(e,l),c[0]&4&&s!==(s=(f[41]??"")+"")&&St(i,s),c[0]&4&&o!==(o=f[39]==1?"":`(occu=${f[39]})`)&&St(a,o)},d(f){f&&(b(t),b(r),b(a))}}}function _s(n){let t,l,e=ol(n[37])+"",s,i;return{c(){t=P("br"),l=oe(`
        dist=`),s=oe(e),i=oe(" Å (no PBC yet)")},l(r){t=M(r,"BR",{}),l=ae(r,`
        dist=`),s=ae(r,e),i=ae(r," Å (no PBC yet)")},m(r,o){O(r,t,o),O(r,l,o),O(r,s,o),O(r,i,o)},p(r,o){o[0]&12&&e!==(e=ol(r[37])+"")&&St(s,e)},d(r){r&&(b(t),b(l),b(s),b(i))}}}function na(n){let t,l,e=n[2].xyz.map(n[35]).join(", ")+"",s,i,r=lt(n[2].species??[]),o=[];for(let f=0;f<r.length;f+=1)o[f]=ms(Jl(n,r,f));let a=n[3]&&n[3]!=n[2]&&n[19]&&_s(tl(n));return{c(){t=P("div");for(let f=0;f<o.length;f+=1)o[f].c();l=oe(`
      (`),s=oe(e),i=oe(`)
      
      
      `),a&&a.c(),this.h()},l(f){t=M(f,"DIV",{class:!0});var c=q(t);for(let u=0;u<o.length;u+=1)o[u].l(c);l=ae(c,`
      (`),s=ae(c,e),i=ae(c,`)
      
      
      `),a&&a.l(c),c.forEach(b),this.h()},h(){h(t,"class","tooltip svelte-gslzlw")},m(f,c){O(f,t,c);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(t,null);y(t,l),y(t,s),y(t,i),a&&a.m(t,null)},p(f,c){if(c[0]&4){r=lt(f[2].species??[]);let u;for(u=0;u<r.length;u+=1){const m=Jl(f,r,u);o[u]?o[u].p(m,c):(o[u]=ms(m),o[u].c(),o[u].m(t,l))}for(;u<o.length;u+=1)o[u].d(1);o.length=r.length}c[0]&32772&&e!==(e=f[2].xyz.map(f[35]).join(", ")+"")&&St(s,e),f[3]&&f[3]!=f[2]&&f[19]?a?a.p(tl(f),c):(a=_s(tl(f)),a.c(),a.m(t,null)):a&&(a.d(1),a=null)},d(f){f&&b(t),Qt(o,f),a&&a.d()}}}function ds(n){var i,r;let t,l;const e=[{matrix:(r=(i=n[4])==null?void 0:i.lattice)==null?void 0:r.matrix},n[27]];let s={};for(let o=0;o<e.length;o+=1)s=Xe(s,e[o]);return t=new Lo({props:s}),{c(){$(t.$$.fragment)},l(o){ee(t.$$.fragment,o)},m(o,a){te(t,o,a),l=!0},p(o,a){var c,u;const f=a[0]&134217744?Jt(e,[a[0]&16&&{matrix:(u=(c=o[4])==null?void 0:c.lattice)==null?void 0:u.matrix},a[0]&134217728&&cn(o[27])]):{};t.$set(f)},i(o){l||(p(t.$$.fragment,o),l=!0)},o(o){S(t.$$.fragment,o),l=!1},d(o){ne(t,o)}}}function la(n){var H,Y;let t,l,e,s,i,r,o,a,f,c,u,m,_;t=new Ce.PerspectiveCamera({props:{makeDefault:!0,position:n[7],fov:n[20],$$slots:{default:[Qo]},$$scope:{ctx:n}}}),e=new Ce.DirectionalLight({props:{position:[3,10,10],intensity:n[22]}}),i=new Ce.AmbientLight({props:{intensity:n[21]}});let g=n[13]&&((H=n[4])==null?void 0:H.sites)&&ns(n),T=n[14]&&is(n),k=lt([{site:n[2],opacity:.2},{site:n[3],opacity:.3}]),w=[];for(let v=0;v<2;v+=1)w[v]=cs(xl(n,k,v));const j=v=>S(w[v],1,1,()=>{w[v]=null});let z=n[3]&&n[2]&&n[19]&&fs(nl(n)),B=n[2]&&us(n),I=((Y=n[4])==null?void 0:Y.lattice)&&ds(n);return{c(){$(t.$$.fragment),l=D(),$(e.$$.fragment),s=D(),$(i.$$.fragment),r=D(),g&&g.c(),o=D(),T&&T.c(),a=D();for(let v=0;v<2;v+=1)w[v].c();f=D(),z&&z.c(),c=D(),B&&B.c(),u=D(),I&&I.c(),m=_e()},l(v){ee(t.$$.fragment,v),l=V(v),ee(e.$$.fragment,v),s=V(v),ee(i.$$.fragment,v),r=V(v),g&&g.l(v),o=V(v),T&&T.l(v),a=V(v);for(let L=0;L<2;L+=1)w[L].l(v);f=V(v),z&&z.l(v),c=V(v),B&&B.l(v),u=V(v),I&&I.l(v),m=_e()},m(v,L){te(t,v,L),O(v,l,L),te(e,v,L),O(v,s,L),te(i,v,L),O(v,r,L),g&&g.m(v,L),O(v,o,L),T&&T.m(v,L),O(v,a,L);for(let Q=0;Q<2;Q+=1)w[Q]&&w[Q].m(v,L);O(v,f,L),z&&z.m(v,L),O(v,c,L),B&&B.m(v,L),O(v,u,L),I&&I.m(v,L),O(v,m,L),_=!0},p(v,L){var se,U;const Q={};L[0]&128&&(Q.position=v[7]),L[0]&1048576&&(Q.fov=v[20]),L[0]&73488|L[1]&32&&(Q.$$scope={dirty:L,ctx:v}),t.$set(Q);const N={};L[0]&4194304&&(N.intensity=v[22]),e.$set(N);const re={};if(L[0]&2097152&&(re.intensity=v[21]),i.$set(re),v[13]&&((se=v[4])!=null&&se.sites)?g?(g.p(v,L),L[0]&8208&&p(g,1)):(g=ns(v),g.c(),p(g,1),g.m(o.parentNode,o)):g&&(we(),S(g,1,1,()=>{g=null}),Se()),v[14]?T?(T.p(v,L),L[0]&16384&&p(T,1)):(T=is(v),T.c(),p(T,1),T.m(a.parentNode,a)):T&&(we(),S(T,1,1,()=>{T=null}),Se()),L[0]&108){k=lt([{site:v[2],opacity:.2},{site:v[3],opacity:.3}]);let Z;for(Z=0;Z<2;Z+=1){const ie=xl(v,k,Z);w[Z]?(w[Z].p(ie,L),p(w[Z],1)):(w[Z]=cs(ie),w[Z].c(),p(w[Z],1),w[Z].m(f.parentNode,f))}for(we(),Z=2;Z<2;Z+=1)j(Z);Se()}v[3]&&v[2]&&v[19]?z?(z.p(nl(v),L),L[0]&524300&&p(z,1)):(z=fs(nl(v)),z.c(),p(z,1),z.m(c.parentNode,c)):z&&(we(),S(z,1,1,()=>{z=null}),Se()),v[2]?B?(B.p(v,L),L[0]&4&&p(B,1)):(B=us(v),B.c(),p(B,1),B.m(u.parentNode,u)):B&&(we(),S(B,1,1,()=>{B=null}),Se()),(U=v[4])!=null&&U.lattice?I?(I.p(v,L),L[0]&16&&p(I,1)):(I=ds(v),I.c(),p(I,1),I.m(m.parentNode,m)):I&&(we(),S(I,1,1,()=>{I=null}),Se())},i(v){if(!_){p(t.$$.fragment,v),p(e.$$.fragment,v),p(i.$$.fragment,v),p(g),p(T);for(let L=0;L<2;L+=1)p(w[L]);p(z),p(B),p(I),_=!0}},o(v){S(t.$$.fragment,v),S(e.$$.fragment,v),S(i.$$.fragment,v),S(g),S(T),w=w.filter(ul);for(let L=0;L<2;L+=1)S(w[L]);S(z),S(B),S(I),_=!1},d(v){v&&(b(l),b(s),b(r),b(o),b(a),b(f),b(c),b(u),b(m)),ne(t,v),ne(e,v),ne(i,v),g&&g.d(v),T&&T.d(v),Qt(w,v),z&&z.d(v),B&&B.d(v),I&&I.d(v)}}}function sa(n,t,l){let e;const s=["structure","atom_radius","same_size_atoms","camera_position","rotation_damping","max_zoom","min_zoom","zoom_speed","pan_speed","show_atoms","show_bonds","hovered_idx","active_idx","hovered_site","active_site","precision","auto_rotate","bond_radius","bond_opacity","bond_color","bonding_strategy","bonding_options","active_hovered_dist","fov","ambient_light","directional_light"];let i=Ct(t,s),r;Qe(n,ln,A=>l(25,r=A));let{$$slots:o={},$$scope:a}=t;const f=Ms(o);let{structure:c=void 0}=t,{atom_radius:u=.5}=t,{same_size_atoms:m=!0}=t,{camera_position:_=[10,0,0]}=t,{rotation_damping:g=.1}=t,{max_zoom:T=void 0}=t,{min_zoom:k=void 0}=t,{zoom_speed:w=.3}=t,{pan_speed:j=1}=t,{show_atoms:z=!0}=t,{show_bonds:B=!0}=t,{hovered_idx:I=null}=t,{active_idx:H=null}=t,{hovered_site:Y=null}=t,{active_site:v=null}=t,{precision:L=".3~f"}=t,{auto_rotate:Q=0}=t,{bond_radius:N=void 0}=t,{bond_opacity:re=.5}=t,{bond_color:se="white"}=t,{bonding_strategy:U="nearest_neighbor"}=t,{bonding_options:Z={}}=t,{active_hovered_dist:ie={color:"green",width:.1,opacity:.5}}=t,{fov:be=50}=t,{ambient_light:ce=1.2}=t,{directional_light:fe=2}=t;Eo();let Le;const de=A=>{l(0,I=A)},Pe=()=>{l(0,I=null)},ue=A=>{H==A?l(1,H=null):l(1,H=A)},ge=A=>ol(A,L);return n.$$set=A=>{t=Xe(Xe({},t),rn(A)),l(27,i=Ct(t,s)),"structure"in A&&l(4,c=A.structure),"atom_radius"in A&&l(5,u=A.atom_radius),"same_size_atoms"in A&&l(6,m=A.same_size_atoms),"camera_position"in A&&l(7,_=A.camera_position),"rotation_damping"in A&&l(8,g=A.rotation_damping),"max_zoom"in A&&l(9,T=A.max_zoom),"min_zoom"in A&&l(10,k=A.min_zoom),"zoom_speed"in A&&l(11,w=A.zoom_speed),"pan_speed"in A&&l(12,j=A.pan_speed),"show_atoms"in A&&l(13,z=A.show_atoms),"show_bonds"in A&&l(14,B=A.show_bonds),"hovered_idx"in A&&l(0,I=A.hovered_idx),"active_idx"in A&&l(1,H=A.active_idx),"hovered_site"in A&&l(2,Y=A.hovered_site),"active_site"in A&&l(3,v=A.active_site),"precision"in A&&l(15,L=A.precision),"auto_rotate"in A&&l(16,Q=A.auto_rotate),"bond_radius"in A&&l(28,N=A.bond_radius),"bond_opacity"in A&&l(17,re=A.bond_opacity),"bond_color"in A&&l(18,se=A.bond_color),"bonding_strategy"in A&&l(29,U=A.bonding_strategy),"bonding_options"in A&&l(30,Z=A.bonding_options),"active_hovered_dist"in A&&l(19,ie=A.active_hovered_dist),"fov"in A&&l(20,be=A.fov),"ambient_light"in A&&l(21,ce=A.ambient_light),"directional_light"in A&&l(22,fe=A.directional_light),"$$scope"in A&&l(36,a=A.$$scope)},n.$$.update=()=>{var A,ye;n.$$.dirty[0]&17&&l(2,Y=((A=c==null?void 0:c.sites)==null?void 0:A[I??-1])??null),n.$$.dirty[0]&18&&l(3,v=((ye=c==null?void 0:c.sites)==null?void 0:ye[H??-1])??null),n.$$.dirty[0]&1610629136&&c!=null&&c.sites&&B&&l(23,Le=Xo[U](c,Z)),n.$$.dirty[0]&268435488&&l(24,e=N??.1*u)},[I,H,Y,v,c,u,m,_,g,T,k,w,j,z,B,L,Q,re,se,ie,be,ce,fe,Le,e,r,f,i,N,U,Z,o,de,Pe,ue,ge,a]}class ia extends Ot{constructor(t){super(),Pt(this,t,sa,la,st,{structure:4,atom_radius:5,same_size_atoms:6,camera_position:7,rotation_damping:8,max_zoom:9,min_zoom:10,zoom_speed:11,pan_speed:12,show_atoms:13,show_bonds:14,hovered_idx:0,active_idx:1,hovered_site:2,active_site:3,precision:15,auto_rotate:16,bond_radius:28,bond_opacity:17,bond_color:18,bonding_strategy:29,bonding_options:30,active_hovered_dist:19,fov:20,ambient_light:21,directional_light:22},null,[-1,-1])}}const oa=n=>({structure:n[0]&16}),hs=n=>({structure:n[4]}),aa=n=>({}),gs=n=>({slot:"atom-label"});function bs(n,t,l){const e=n.slice();return e[99]=t[l],e}const ra=n=>({controls_open:n[0]&2048}),ps=n=>({controls_open:n[11]}),ca=n=>({}),vs=n=>({}),fa=n=>({}),ys=n=>({});function ua(n){let t,l="No structure provided";return{c(){t=P("p"),t.textContent=l,this.h()},l(e){t=M(e,"P",{class:!0,"data-svelte-h":!0}),_t(t)!=="svelte-3go39a"&&(t.textContent=l),this.h()},h(){h(t,"class","warn svelte-1mmac5t")},m(e,s){O(e,t,s)},p:Vt,i:Vt,o:Vt,d(e){e&&b(t)}}}function ma(n){let t,l="No sites found in structure";return{c(){t=P("p"),t.textContent=l,this.h()},l(e){t=M(e,"P",{class:!0,"data-svelte-h":!0}),_t(t)!=="svelte-1ifjfxo"&&(t.textContent=l),this.h()},h(){h(t,"class","warn svelte-1mmac5t")},m(e,s){O(e,t,s)},p:Vt,i:Vt,o:Vt,d(e){e&&b(t)}}}function _a(n){let t,l,e,s,i,r,o,a,f,c,u,m,_,g,T,k,w,j,z,B,I,H,Y,v,L,Q,N,re,se,U,Z,ie,be,ce,fe,Le,de,Pe,ue,ge,A="surface",ye,K="wireframe",G,Me="none",Ne,Oe,le,ze,Ae,Mt,dt,Ut="(Å)",At,Ke,It,Re,Lt,ht,it,Bt,Et,Ht=`Scale sites according to atomic radii
          <small>(if false, all atoms have same size)</small>`,C,pe,Nt,gt,ot,at,Rt,rt,d,F,J,me,he,bt,ke,vt,Zt,Wt,je,et,Kt,tt,zt,yt,vn,De,fn,yn,Ve=n[35]&&ks(n);const un=n[50]["fullscreen-toggle"],$t=Fe(un,n,n[96],vs),Tt=$t||ha(),mn=n[50]["controls-toggle"],en=Fe(mn,n,n[96],ps),ct=en||ga(n);function Un(R){n[55](R)}let kn={elements:wl(n[4])};n[23]!==void 0&&(kn.tips_modal=n[23]),a=new Zo({props:kn}),$e.push(()=>An(a,"tips_modal",Un));let Je=n[31]&&n[15]&&Es(n),qe=n[13]&&Ts(n),Ie=n[31]&&Ss(n),E=lt(Object.keys(al)),Ee=[];for(let R=0;R<E.length;R+=1)Ee[R]=Cs(bs(n,E,R));tt=new ji({props:{rendererParameters:{preserveDrawingBuffer:!0},$$slots:{default:[Ta]},$$scope:{ctx:n}}});const Yt=n[50]["bottom-left"],Ye=Fe(Yt,n,n[96],hs);return{c(){t=P("div"),l=P("section"),Ve&&Ve.c(),e=D(),s=P("button"),Tt&&Tt.c(),i=D(),r=P("button"),ct&&ct.c(),o=D(),$(a.$$.fragment),c=D(),u=P("dialog"),m=P("div"),_=oe("Show "),g=P("label"),T=P("input"),k=oe(`
          atoms`),w=D(),j=P("label"),z=P("input"),B=oe(`
          bonds`),I=D(),H=P("label"),Y=P("input"),v=oe(`
          lattice vectors`),L=D(),Q=P("label"),N=P("input"),re=oe(`
          image atoms`),se=D(),U=P("label"),Z=P("input"),ie=oe(`
          full controls`),be=D(),ce=P("label"),fe=P("input"),Le=oe(`
          site labels`),de=D(),Pe=P("label"),ue=P("select"),ge=P("option"),ge.textContent=A,ye=P("option"),ye.textContent=K,G=P("option"),G.textContent=Me,Ne=oe(`
          unit cell as`),Oe=D(),le=P("hr"),ze=D(),Ae=P("label"),Mt=oe(`Atom radius
        `),dt=P("small"),dt.textContent=Ut,At=D(),Ke=P("input"),It=D(),Re=P("input"),Lt=D(),ht=P("label"),it=P("input"),Bt=D(),Et=P("span"),Et.innerHTML=Ht,C=D(),Je&&Je.c(),pe=D(),qe&&qe.c(),Nt=D(),gt=P("label"),ot=oe(`Background color
        `),at=P("input"),Rt=D(),rt=P("hr"),d=D(),Ie&&Ie.c(),F=D(),J=P("label"),me=oe(`Color scheme
        `),he=P("select");for(let R=0;R<Ee.length;R+=1)Ee[R].c();bt=D(),ke=P("span"),vt=P("button"),Zt=oe(n[36]),Wt=D(),je=P("button"),et=oe(n[37]),Kt=D(),$(tt.$$.fragment),zt=D(),yt=P("div"),Ye&&Ye.c(),this.h()},l(R){t=M(R,"DIV",{class:!0,style:!0,role:!0});var W=q(t);l=M(W,"SECTION",{class:!0});var ft=q(l);Ve&&Ve.l(ft),e=V(ft),s=M(ft,"BUTTON",{class:!0,title:!0});var _n=q(s);Tt&&Tt.l(_n),_n.forEach(b),i=V(ft),r=M(ft,"BUTTON",{class:!0});var ut=q(r);ct&&ct.l(ut),ut.forEach(b),ft.forEach(b),o=V(W),ee(a.$$.fragment,W),c=V(W),u=M(W,"DIALOG",{class:!0});var Te=q(u);m=M(Te,"DIV",{style:!0});var mt=q(m);_=ae(mt,"Show "),g=M(mt,"LABEL",{class:!0});var Bn=q(g);T=M(Bn,"INPUT",{type:!0,class:!0}),k=ae(Bn,`
          atoms`),Bn.forEach(b),w=V(mt),j=M(mt,"LABEL",{class:!0});var Hn=q(j);z=M(Hn,"INPUT",{type:!0,class:!0}),B=ae(Hn,`
          bonds`),Hn.forEach(b),I=V(mt),H=M(mt,"LABEL",{class:!0});var Kn=q(H);Y=M(Kn,"INPUT",{type:!0,class:!0}),v=ae(Kn,`
          lattice vectors`),Kn.forEach(b),L=V(mt),Q=M(mt,"LABEL",{class:!0});var Yn=q(Q);N=M(Yn,"INPUT",{type:!0,class:!0}),re=ae(Yn,`
          image atoms`),Yn.forEach(b),se=V(mt),U=M(mt,"LABEL",{class:!0});var Fn=q(U);Z=M(Fn,"INPUT",{type:!0,class:!0}),ie=ae(Fn,`
          full controls`),Fn.forEach(b),be=V(mt),ce=M(mt,"LABEL",{class:!0});var Zn=q(ce);fe=M(Zn,"INPUT",{type:!0,class:!0}),Le=ae(Zn,`
          site labels`),Zn.forEach(b),de=V(mt),Pe=M(mt,"LABEL",{class:!0});var Wn=q(Pe);ue=M(Wn,"SELECT",{class:!0});var En=q(ue);ge=M(En,"OPTION",{"data-svelte-h":!0}),_t(ge)!=="svelte-2irg8s"&&(ge.textContent=A),ye=M(En,"OPTION",{"data-svelte-h":!0}),_t(ye)!=="svelte-mavpry"&&(ye.textContent=K),G=M(En,"OPTION",{"data-svelte-h":!0}),_t(G)!=="svelte-1jd81zj"&&(G.textContent=Me),En.forEach(b),Ne=ae(Wn,`
          unit cell as`),Wn.forEach(b),mt.forEach(b),Oe=V(Te),le=M(Te,"HR",{class:!0}),ze=V(Te),Ae=M(Te,"LABEL",{class:!0});var xt=q(Ae);Mt=ae(xt,`Atom radius
        `),dt=M(xt,"SMALL",{"data-svelte-h":!0}),_t(dt)!=="svelte-jhuz4e"&&(dt.textContent=Ut),At=V(xt),Ke=M(xt,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),It=V(xt),Re=M(xt,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),xt.forEach(b),Lt=V(Te),ht=M(Te,"LABEL",{class:!0});var Tn=q(ht);it=M(Tn,"INPUT",{type:!0,class:!0}),Bt=V(Tn),Et=M(Tn,"SPAN",{"data-svelte-h":!0}),_t(Et)!=="svelte-1qgldh7"&&(Et.innerHTML=Ht),Tn.forEach(b),C=V(Te),Je&&Je.l(Te),pe=V(Te),qe&&qe.l(Te),Nt=V(Te),gt=M(Te,"LABEL",{class:!0});var Gn=q(gt);ot=ae(Gn,`Background color
        `),at=M(Gn,"INPUT",{type:!0,class:!0}),Gn.forEach(b),Rt=V(Te),rt=M(Te,"HR",{class:!0}),d=V(Te),Ie&&Ie.l(Te),F=V(Te),J=M(Te,"LABEL",{class:!0});var Xn=q(J);me=ae(Xn,`Color scheme
        `),he=M(Xn,"SELECT",{class:!0});var ml=q(he);for(let qn=0;qn<Ee.length;qn+=1)Ee[qn].l(ml);ml.forEach(b),Xn.forEach(b),bt=V(Te),ke=M(Te,"SPAN",{style:!0});var wn=q(ke);vt=M(wn,"BUTTON",{type:!0,title:!0,class:!0});var _l=q(vt);Zt=ae(_l,n[36]),_l.forEach(b),Wt=V(wn),je=M(wn,"BUTTON",{type:!0,title:!0,class:!0});var dl=q(je);et=ae(dl,n[37]),dl.forEach(b),wn.forEach(b),Te.forEach(b),Kt=V(W),ee(tt.$$.fragment,W),zt=V(W),yt=M(W,"DIV",{class:!0});var hl=q(yt);Ye&&Ye.l(hl),hl.forEach(b),W.forEach(b),this.h()},h(){h(s,"class","fullscreen-toggle"),h(s,"title","Toggle fullscreen"),h(r,"class","controls-toggle"),h(l,"class","svelte-1mmac5t"),Cn(l,"visible",n[41]),h(T,"type","checkbox"),h(T,"class","svelte-1mmac5t"),h(g,"class","svelte-1mmac5t"),h(z,"type","checkbox"),h(z,"class","svelte-1mmac5t"),h(j,"class","svelte-1mmac5t"),h(Y,"type","checkbox"),h(Y,"class","svelte-1mmac5t"),h(H,"class","svelte-1mmac5t"),h(N,"type","checkbox"),h(N,"class","svelte-1mmac5t"),h(Q,"class","svelte-1mmac5t"),h(Z,"type","checkbox"),h(Z,"class","svelte-1mmac5t"),h(U,"class","svelte-1mmac5t"),h(fe,"type","checkbox"),h(fe,"class","svelte-1mmac5t"),h(ce,"class","svelte-1mmac5t"),ge.__value="surface",x(ge,ge.__value),ye.__value="wireframe",x(ye,ye.__value),G.__value=null,x(G,G.__value),h(ue,"class","svelte-1mmac5t"),n[15]===void 0&&hn(()=>n[62].call(ue)),h(Pe,"class","svelte-1mmac5t"),He(m,"display","flex"),He(m,"align-items","center"),He(m,"gap","4pt"),He(m,"flex-wrap","wrap"),h(le,"class","svelte-1mmac5t"),h(Ke,"type","number"),h(Ke,"min","0.1"),h(Ke,"max",1),h(Ke,"step",.05),h(Ke,"class","svelte-1mmac5t"),h(Re,"type","range"),h(Re,"min","0.1"),h(Re,"max",1),h(Re,"step",.05),h(Re,"class","svelte-1mmac5t"),h(Ae,"class","svelte-1mmac5t"),h(it,"type","checkbox"),h(it,"class","svelte-1mmac5t"),h(ht,"class","svelte-1mmac5t"),h(at,"type","color"),h(at,"class","svelte-1mmac5t"),h(gt,"class","svelte-1mmac5t"),h(rt,"class","svelte-1mmac5t"),h(he,"class","svelte-1mmac5t"),n[3]===void 0&&hn(()=>n[86].call(he)),h(J,"class","svelte-1mmac5t"),h(vt,"type","button"),h(vt,"title",n[36]),h(vt,"class","svelte-1mmac5t"),h(je,"type","button"),h(je,"title",n[37]),h(je,"class","svelte-1mmac5t"),He(ke,"display","flex"),He(ke,"gap","4pt"),He(ke,"margin","3pt 0 0"),h(u,"class","controls svelte-1mmac5t"),u.open=n[11],h(yt,"class","bottom-left svelte-1mmac5t"),h(t,"class","structure svelte-1mmac5t"),h(t,"style",n[39]),h(t,"role","region"),hn(()=>n[91].call(t)),Cn(t,"dragover",n[22])},m(R,W){O(R,t,W),y(t,l),Ve&&Ve.m(l,null),y(l,e),y(l,s),Tt&&Tt.m(s,null),y(l,i),y(l,r),ct&&ct.m(r,null),n[54](r),y(t,o),te(a,t,null),y(t,c),y(t,u),y(u,m),y(m,_),y(m,g),y(g,T),T.checked=n[12],y(g,k),y(m,w),y(m,j),y(j,z),z.checked=n[13],y(j,B),y(m,I),y(m,H),y(H,Y),Y.checked=n[19],y(H,v),y(m,L),y(m,Q),y(Q,N),N.checked=n[28],y(Q,re),y(m,se),y(m,U),y(U,Z),Z.checked=n[31],y(U,ie),y(m,be),y(m,ce),y(ce,fe),fe.checked=n[24],y(ce,Le),y(m,de),y(m,Pe),y(Pe,ue),y(ue,ge),y(ue,ye),y(ue,G),Xt(ue,n[15],!0),y(Pe,Ne),y(u,Oe),y(u,le),y(u,ze),y(u,Ae),y(Ae,Mt),y(Ae,dt),y(Ae,At),y(Ae,Ke),x(Ke,n[5]),y(Ae,It),y(Ae,Re),x(Re,n[5]),y(u,Lt),y(u,ht),y(ht,it),it.checked=n[6],y(ht,Bt),y(ht,Et),y(u,C),Je&&Je.m(u,null),y(u,pe),qe&&qe.m(u,null),y(u,Nt),y(u,gt),y(gt,ot),y(gt,at),x(at,n[0]),y(u,Rt),y(u,rt),y(u,d),Ie&&Ie.m(u,null),y(u,F),y(u,J),y(J,me),y(J,he);for(let ft=0;ft<Ee.length;ft+=1)Ee[ft]&&Ee[ft].m(he,null);Xt(he,n[3],!0),y(u,bt),y(u,ke),y(ke,vt),y(vt,Zt),y(ke,Wt),y(ke,je),y(je,et),n[87](u),y(t,Kt),te(tt,t,null),y(t,zt),y(t,yt),Ye&&Ye.m(yt,null),n[90](t),vn=Fs(t,n[91].bind(t)),De=!0,fn||(yn=[X(s,"click",n[40]),X(r,"click",n[53]),X(T,"change",n[56]),X(z,"change",n[57]),X(Y,"change",n[58]),X(N,"change",n[59]),X(Z,"change",n[60]),X(fe,"change",n[61]),X(ue,"change",n[62]),X(Ke,"input",n[63]),X(Re,"change",n[64]),X(Re,"input",n[64]),X(it,"change",n[65]),X(at,"input",n[73]),X(he,"change",n[86]),X(vt,"click",n[44]),X(je,"click",n[46]),X(t,"mouseenter",n[92]),X(t,"mouseleave",n[93]),X(t,"drop",Mn(n[45])),X(t,"dragover",Mn(n[94])),X(t,"dragleave",Mn(n[95]))],fn=!0)},p(R,W){R[35]?Ve?(Ve.p(R,W),W[1]&16&&p(Ve,1)):(Ve=ks(R),Ve.c(),p(Ve,1),Ve.m(l,e)):Ve&&(we(),S(Ve,1,1,()=>{Ve=null}),Se()),$t&&$t.p&&(!De||W[3]&8)&&Ze($t,un,R,R[96],De?Ge(un,R[96],W,ca):We(R[96]),vs),en?en.p&&(!De||W[0]&2048|W[3]&8)&&Ze(en,mn,R,R[96],De?Ge(mn,R[96],W,ra):We(R[96]),ps):ct&&ct.p&&(!De||W[0]&2048)&&ct.p(R,De?W:[-1,-1,-1,-1]),(!De||W[1]&1024)&&Cn(l,"visible",R[41]);const ft={};if(W[0]&16&&(ft.elements=wl(R[4])),!f&&W[0]&8388608&&(f=!0,ft.tips_modal=R[23],zn(()=>f=!1)),a.$set(ft),W[0]&4096&&(T.checked=R[12]),W[0]&8192&&(z.checked=R[13]),W[0]&524288&&(Y.checked=R[19]),W[0]&268435456&&(N.checked=R[28]),W[1]&1&&(Z.checked=R[31]),W[0]&16777216&&(fe.checked=R[24]),W[0]&32768&&Xt(ue,R[15]),W[0]&32&&ve(Ke.value)!==R[5]&&x(Ke,R[5]),W[0]&32&&x(Re,R[5]),W[0]&64&&(it.checked=R[6]),R[31]&&R[15]?Je?Je.p(R,W):(Je=Es(R),Je.c(),Je.m(u,pe)):Je&&(Je.d(1),Je=null),R[13]?qe?qe.p(R,W):(qe=Ts(R),qe.c(),qe.m(u,Nt)):qe&&(qe.d(1),qe=null),W[0]&1&&x(at,R[0]),R[31]?Ie?(Ie.p(R,W),W[1]&1&&p(Ie,1)):(Ie=Ss(R),Ie.c(),p(Ie,1),Ie.m(u,F)):Ie&&(we(),S(Ie,1,1,()=>{Ie=null}),Se()),W&0){E=lt(Object.keys(al));let ut;for(ut=0;ut<E.length;ut+=1){const Te=bs(R,E,ut);Ee[ut]?Ee[ut].p(Te,W):(Ee[ut]=Cs(Te),Ee[ut].c(),Ee[ut].m(he,null))}for(;ut<Ee.length;ut+=1)Ee[ut].d(1);Ee.length=E.length}W[0]&8&&Xt(he,R[3]),(!De||W[1]&32)&&St(Zt,R[36]),(!De||W[1]&32)&&h(vt,"title",R[36]),(!De||W[1]&64)&&St(et,R[37]),(!De||W[1]&64)&&h(je,"title",R[37]),(!De||W[0]&2048)&&(u.open=R[11]);const _n={};W[0]&2131359728|W[1]&65670|W[3]&8&&(_n.$$scope={dirty:W,ctx:R}),tt.$set(_n),Ye&&Ye.p&&(!De||W[0]&16|W[3]&8)&&Ze(Ye,Yt,R,R[96],De?Ge(Yt,R[96],W,oa):We(R[96]),hs),(!De||W[1]&256)&&h(t,"style",R[39]),(!De||W[0]&4194304)&&Cn(t,"dragover",R[22])},i(R){De||(p(Ve),p(Tt,R),p(ct,R),p(a.$$.fragment,R),p(Ie),p(tt.$$.fragment,R),p(Ye,R),De=!0)},o(R){S(Ve),S(Tt,R),S(ct,R),S(a.$$.fragment,R),S(Ie),S(tt.$$.fragment,R),S(Ye,R),De=!1},d(R){R&&b(t),Ve&&Ve.d(),Tt&&Tt.d(R),ct&&ct.d(R),n[54](null),ne(a),Je&&Je.d(),qe&&qe.d(),Ie&&Ie.d(),Qt(Ee,R),n[87](null),ne(tt),Ye&&Ye.d(R),n[90](null),vn(),fn=!1,qt(yn)}}}function ks(n){let t,l,e,s;const i=n[50]["tips-icon"],r=Fe(i,n,n[96],ys),o=r||da();return{c(){t=P("button"),o&&o.c(),this.h()},l(a){t=M(a,"BUTTON",{class:!0});var f=q(t);o&&o.l(f),f.forEach(b),this.h()},h(){h(t,"class","info-icon")},m(a,f){O(a,t,f),o&&o.m(t,null),l=!0,e||(s=X(t,"click",n[52]),e=!0)},p(a,f){r&&r.p&&(!l||f[3]&8)&&Ze(r,i,a,a[96],l?Ge(i,a[96],f,fa):We(a[96]),ys)},i(a){l||(p(o,a),l=!0)},o(a){S(o,a),l=!1},d(a){a&&b(t),o&&o.d(a),e=!1,s()}}}function da(n){let t;return{c(){t=oe("ⓘ")},l(l){t=ae(l,"ⓘ")},m(l,e){O(l,t,e)},d(l){l&&b(t)}}}function ha(n){let t;return{c(){t=oe("⛶")},l(l){t=ae(l,"⛶")},m(l,e){O(l,t,e)},d(l){l&&b(t)}}}function ga(n){let t=n[11]?"Close":"Controls",l;return{c(){l=oe(t)},l(e){l=ae(e,t)},m(e,s){O(e,l,s)},p(e,s){s[0]&2048&&t!==(t=e[11]?"Close":"Controls")&&St(l,t)},d(e){e&&b(l)}}}function Es(n){let t,l,e,s,i,r,o,a,f;return{c(){t=P("hr"),l=D(),e=P("label"),s=oe(`Unit cell opacity
          `),i=P("input"),r=D(),o=P("input"),this.h()},l(c){t=M(c,"HR",{class:!0}),l=V(c),e=M(c,"LABEL",{class:!0});var u=q(e);s=ae(u,`Unit cell opacity
          `),i=M(u,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),r=V(u),o=M(u,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),u.forEach(b),this.h()},h(){h(t,"class","svelte-1mmac5t"),h(i,"type","number"),h(i,"min",0),h(i,"max",1),h(i,"step",.05),h(i,"class","svelte-1mmac5t"),h(o,"type","range"),h(o,"min",0),h(o,"max",1),h(o,"step",.05),h(o,"class","svelte-1mmac5t"),h(e,"class","svelte-1mmac5t")},m(c,u){O(c,t,u),O(c,l,u),O(c,e,u),y(e,s),y(e,i),x(i,n[16]),y(e,r),y(e,o),x(o,n[16]),a||(f=[X(i,"input",n[66]),X(o,"change",n[67]),X(o,"input",n[67])],a=!0)},p(c,u){u[0]&65536&&ve(i.value)!==c[16]&&x(i,c[16]),u[0]&65536&&x(o,c[16])},d(c){c&&(b(t),b(l),b(e)),a=!1,qt(f)}}}function Ts(n){let t,l,e,s,i,r,o="Max Distance",a,f="Nearest Neighbor",c,u,m,_,g,T="Single",k,w="Split Midpoint",j,z="Gradient (TODO)",B,I,H,Y,v,L,Q,N,re,se=n[26]==="single"&&ws(n);return{c(){t=P("hr"),l=D(),e=P("label"),s=oe(`Bonding strategy
          `),i=P("select"),r=P("option"),r.textContent=o,a=P("option"),a.textContent=f,c=D(),u=P("label"),m=oe(`Bond color mode
          `),_=P("select"),g=P("option"),g.textContent=T,k=P("option"),k.textContent=w,j=P("option"),j.textContent=z,B=D(),se&&se.c(),I=D(),H=P("label"),Y=oe(`Bond radius
          `),v=P("input"),L=D(),Q=P("input"),this.h()},l(U){t=M(U,"HR",{class:!0}),l=V(U),e=M(U,"LABEL",{class:!0});var Z=q(e);s=ae(Z,`Bonding strategy
          `),i=M(Z,"SELECT",{class:!0});var ie=q(i);r=M(ie,"OPTION",{"data-svelte-h":!0}),_t(r)!=="svelte-1py7gbk"&&(r.textContent=o),a=M(ie,"OPTION",{"data-svelte-h":!0}),_t(a)!=="svelte-1u00ljx"&&(a.textContent=f),ie.forEach(b),Z.forEach(b),c=V(U),u=M(U,"LABEL",{class:!0});var be=q(u);m=ae(be,`Bond color mode
          `),_=M(be,"SELECT",{class:!0});var ce=q(_);g=M(ce,"OPTION",{"data-svelte-h":!0}),_t(g)!=="svelte-mm641a"&&(g.textContent=T),k=M(ce,"OPTION",{"data-svelte-h":!0}),_t(k)!=="svelte-8dv12f"&&(k.textContent=w),j=M(ce,"OPTION",{"data-svelte-h":!0}),_t(j)!=="svelte-1f2hktf"&&(j.textContent=z),ce.forEach(b),be.forEach(b),B=V(U),se&&se.l(U),I=V(U),H=M(U,"LABEL",{class:!0});var fe=q(H);Y=ae(fe,`Bond radius
          `),v=M(fe,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),L=V(fe),Q=M(fe,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),fe.forEach(b),this.h()},h(){h(t,"class","svelte-1mmac5t"),r.__value="max_dist",x(r,r.__value),a.__value="nearest_neighbor",x(a,a.__value),h(i,"class","svelte-1mmac5t"),n[25]===void 0&&hn(()=>n[68].call(i)),h(e,"class","svelte-1mmac5t"),g.__value="single",x(g,g.__value),k.__value="split-midpoint",x(k,k.__value),j.__value="gradient",x(j,j.__value),j.disabled=!0,h(_,"class","svelte-1mmac5t"),n[26]===void 0&&hn(()=>n[69].call(_)),h(u,"class","svelte-1mmac5t"),h(v,"type","number"),h(v,"min",.001),h(v,"max",.1),h(v,"step",.001),h(v,"class","svelte-1mmac5t"),h(Q,"type","range"),h(Q,"min","0.001"),h(Q,"max","0.1"),h(Q,"step",.001),h(Q,"class","svelte-1mmac5t"),h(H,"class","svelte-1mmac5t")},m(U,Z){O(U,t,Z),O(U,l,Z),O(U,e,Z),y(e,s),y(e,i),y(i,r),y(i,a),Xt(i,n[25],!0),O(U,c,Z),O(U,u,Z),y(u,m),y(u,_),y(_,g),y(_,k),y(_,j),Xt(_,n[26],!0),O(U,B,Z),se&&se.m(U,Z),O(U,I,Z),O(U,H,Z),y(H,Y),y(H,v),x(v,n[14]),y(H,L),y(H,Q),x(Q,n[14]),N||(re=[X(i,"change",n[68]),X(_,"change",n[69]),X(v,"input",n[71]),X(Q,"change",n[72]),X(Q,"input",n[72])],N=!0)},p(U,Z){Z[0]&33554432&&Xt(i,U[25]),Z[0]&67108864&&Xt(_,U[26]),U[26]==="single"?se?se.p(U,Z):(se=ws(U),se.c(),se.m(I.parentNode,I)):se&&(se.d(1),se=null),Z[0]&16384&&ve(v.value)!==U[14]&&x(v,U[14]),Z[0]&16384&&x(Q,U[14])},d(U){U&&(b(t),b(l),b(e),b(c),b(u),b(B),b(I),b(H)),se&&se.d(U),N=!1,qt(re)}}}function ws(n){let t,l,e,s,i;return{c(){t=P("label"),l=oe(`Bond color
            `),e=P("input"),this.h()},l(r){t=M(r,"LABEL",{class:!0});var o=q(t);l=ae(o,`Bond color
            `),e=M(o,"INPUT",{type:!0,class:!0}),o.forEach(b),this.h()},h(){h(e,"type","color"),h(e,"class","svelte-1mmac5t"),h(t,"class","svelte-1mmac5t")},m(r,o){O(r,t,o),y(t,l),y(t,e),x(e,n[27]),s||(i=X(e,"input",n[70]),s=!0)},p(r,o){o[0]&134217728&&x(e,r[27])},d(r){r&&b(t),s=!1,i()}}}function Ss(n){let t,l,e,s,i,r,o,a,f,c,u,m,_,g,T,k,w,j,z,B,I,H,Y,v,L,Q,N,re,se,U,Z,ie,be,ce,fe,Le,de,Pe,ue,ge,A,ye;return g=new dn({props:{text:"pan by clicking and dragging while holding cmd, ctrl or shift",$$slots:{default:[ba]},$$scope:{ctx:n}}}),I=new dn({props:{text:"intensity of the directional light",$$slots:{default:[pa]},$$scope:{ctx:n}}}),re=new dn({props:{text:"intensity of the ambient light",$$slots:{default:[va]},$$scope:{ctx:n}}}),fe=new dn({props:{text:"damping factor for rotation",$$slots:{default:[ya]},$$scope:{ctx:n}}}),{c(){t=P("label"),l=oe(`Auto rotate speed
          `),e=P("input"),s=D(),i=P("input"),r=D(),o=P("label"),a=oe(`Zoom speed
          `),f=P("input"),c=D(),u=P("input"),m=D(),_=P("label"),$(g.$$.fragment),T=D(),k=P("input"),w=D(),j=P("input"),z=D(),B=P("label"),$(I.$$.fragment),H=D(),Y=P("input"),v=D(),L=P("input"),Q=D(),N=P("label"),$(re.$$.fragment),se=D(),U=P("input"),Z=D(),ie=P("input"),be=D(),ce=P("label"),$(fe.$$.fragment),Le=D(),de=P("input"),Pe=D(),ue=P("input"),this.h()},l(K){t=M(K,"LABEL",{class:!0});var G=q(t);l=ae(G,`Auto rotate speed
          `),e=M(G,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),s=V(G),i=M(G,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),G.forEach(b),r=V(K),o=M(K,"LABEL",{class:!0});var Me=q(o);a=ae(Me,`Zoom speed
          `),f=M(Me,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),c=V(Me),u=M(Me,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),Me.forEach(b),m=V(K),_=M(K,"LABEL",{class:!0});var Ne=q(_);ee(g.$$.fragment,Ne),T=V(Ne),k=M(Ne,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),w=V(Ne),j=M(Ne,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),Ne.forEach(b),z=V(K),B=M(K,"LABEL",{class:!0});var Oe=q(B);ee(I.$$.fragment,Oe),H=V(Oe),Y=M(Oe,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),v=V(Oe),L=M(Oe,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),Oe.forEach(b),Q=V(K),N=M(K,"LABEL",{class:!0});var le=q(N);ee(re.$$.fragment,le),se=V(le),U=M(le,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),Z=V(le),ie=M(le,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),le.forEach(b),be=V(K),ce=M(K,"LABEL",{class:!0});var ze=q(ce);ee(fe.$$.fragment,ze),Le=V(ze),de=M(ze,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),Pe=V(ze),ue=M(ze,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),ze.forEach(b),this.h()},h(){h(e,"type","number"),h(e,"min",0),h(e,"max",2),h(e,"step",.01),h(e,"class","svelte-1mmac5t"),h(i,"type","range"),h(i,"min",0),h(i,"max",2),h(i,"step",.01),h(i,"class","svelte-1mmac5t"),h(t,"class","svelte-1mmac5t"),h(f,"type","number"),h(f,"min",0),h(f,"max",2),h(f,"step",.01),h(f,"class","svelte-1mmac5t"),h(u,"type","range"),h(u,"min",0),h(u,"max",2),h(u,"step",.01),h(u,"class","svelte-1mmac5t"),h(o,"class","svelte-1mmac5t"),h(k,"type","number"),h(k,"min",0),h(k,"max",2),h(k,"step",.01),h(k,"class","svelte-1mmac5t"),h(j,"type","range"),h(j,"min",0),h(j,"max",2),h(j,"step",.01),h(j,"class","svelte-1mmac5t"),h(_,"class","svelte-1mmac5t"),h(Y,"type","number"),h(Y,"min",0),h(Y,"max",4),h(Y,"step",.01),h(Y,"class","svelte-1mmac5t"),h(L,"type","range"),h(L,"min",0),h(L,"max",4),h(L,"step",.01),h(L,"class","svelte-1mmac5t"),h(B,"class","svelte-1mmac5t"),h(U,"type","number"),h(U,"min",0),h(U,"max",2),h(U,"step",.01),h(U,"class","svelte-1mmac5t"),h(ie,"type","range"),h(ie,"min",0),h(ie,"max",2),h(ie,"step",.01),h(ie,"class","svelte-1mmac5t"),h(N,"class","svelte-1mmac5t"),h(de,"type","number"),h(de,"min",0),h(de,"max",.3),h(de,"step",.01),h(de,"class","svelte-1mmac5t"),h(ue,"type","range"),h(ue,"min",0),h(ue,"max",.3),h(ue,"step",.01),h(ue,"class","svelte-1mmac5t"),h(ce,"class","svelte-1mmac5t")},m(K,G){O(K,t,G),y(t,l),y(t,e),x(e,n[7]),y(t,s),y(t,i),x(i,n[7]),O(K,r,G),O(K,o,G),y(o,a),y(o,f),x(f,n[9]),y(o,c),y(o,u),x(u,n[9]),O(K,m,G),O(K,_,G),te(g,_,null),y(_,T),y(_,k),x(k,n[10]),y(_,w),y(_,j),x(j,n[10]),O(K,z,G),O(K,B,G),te(I,B,null),y(B,H),y(B,Y),x(Y,n[29]),y(B,v),y(B,L),x(L,n[29]),O(K,Q,G),O(K,N,G),te(re,N,null),y(N,se),y(N,U),x(U,n[30]),y(N,Z),y(N,ie),x(ie,n[30]),O(K,be,G),O(K,ce,G),te(fe,ce,null),y(ce,Le),y(ce,de),x(de,n[8]),y(ce,Pe),y(ce,ue),x(ue,n[8]),ge=!0,A||(ye=[X(e,"input",n[74]),X(i,"change",n[75]),X(i,"input",n[75]),X(f,"input",n[76]),X(u,"change",n[77]),X(u,"input",n[77]),X(k,"input",n[78]),X(j,"change",n[79]),X(j,"input",n[79]),X(Y,"input",n[80]),X(L,"change",n[81]),X(L,"input",n[81]),X(U,"input",n[82]),X(ie,"change",n[83]),X(ie,"input",n[83]),X(de,"input",n[84]),X(ue,"change",n[85]),X(ue,"input",n[85])],A=!0)},p(K,G){G[0]&128&&ve(e.value)!==K[7]&&x(e,K[7]),G[0]&128&&x(i,K[7]),G[0]&512&&ve(f.value)!==K[9]&&x(f,K[9]),G[0]&512&&x(u,K[9]);const Me={};G[3]&8&&(Me.$$scope={dirty:G,ctx:K}),g.$set(Me),G[0]&1024&&ve(k.value)!==K[10]&&x(k,K[10]),G[0]&1024&&x(j,K[10]);const Ne={};G[3]&8&&(Ne.$$scope={dirty:G,ctx:K}),I.$set(Ne),G[0]&536870912&&ve(Y.value)!==K[29]&&x(Y,K[29]),G[0]&536870912&&x(L,K[29]);const Oe={};G[3]&8&&(Oe.$$scope={dirty:G,ctx:K}),re.$set(Oe),G[0]&1073741824&&ve(U.value)!==K[30]&&x(U,K[30]),G[0]&1073741824&&x(ie,K[30]);const le={};G[3]&8&&(le.$$scope={dirty:G,ctx:K}),fe.$set(le),G[0]&256&&ve(de.value)!==K[8]&&x(de,K[8]),G[0]&256&&x(ue,K[8])},i(K){ge||(p(g.$$.fragment,K),p(I.$$.fragment,K),p(re.$$.fragment,K),p(fe.$$.fragment,K),ge=!0)},o(K){S(g.$$.fragment,K),S(I.$$.fragment,K),S(re.$$.fragment,K),S(fe.$$.fragment,K),ge=!1},d(K){K&&(b(t),b(r),b(o),b(m),b(_),b(z),b(B),b(Q),b(N),b(be),b(ce)),ne(g),ne(I),ne(re),ne(fe),A=!1,qt(ye)}}}function ba(n){let t;return{c(){t=oe("Pan speed")},l(l){t=ae(l,"Pan speed")},m(l,e){O(l,t,e)},d(l){l&&b(t)}}}function pa(n){let t;return{c(){t=oe("Directional light")},l(l){t=ae(l,"Directional light")},m(l,e){O(l,t,e)},d(l){l&&b(t)}}}function va(n){let t;return{c(){t=oe("Ambient light")},l(l){t=ae(l,"Ambient light")},m(l,e){O(l,t,e)},d(l){l&&b(t)}}}function ya(n){let t;return{c(){t=oe("Rotation damping")},l(l){t=ae(l,"Rotation damping")},m(l,e){O(l,t,e)},d(l){l&&b(t)}}}function Cs(n){let t,l=n[99]+"",e;return{c(){t=P("option"),e=oe(l),this.h()},l(s){t=M(s,"OPTION",{});var i=q(t);e=ae(i,l),i.forEach(b),this.h()},h(){t.__value=n[99],x(t,t.__value)},m(s,i){O(s,t,i),y(t,e)},p:Vt,d(s){s&&b(t)}}}function Os(n){let t,l=(n[24]===!0?n[98]:n[24][n[98]])+"",e;return{c(){t=P("span"),e=oe(l),this.h()},l(s){t=M(s,"SPAN",{class:!0,style:!0});var i=q(t);e=ae(i,l),i.forEach(b),this.h()},h(){h(t,"class","atom-label svelte-1mmac5t"),h(t,"style",n[38])},m(s,i){O(s,t,i),y(t,e)},p(s,i){i[0]&16777216|i[3]&32&&l!==(l=(s[24]===!0?s[98]:s[24][s[98]])+"")&&St(e,l),i[1]&128&&h(t,"style",s[38])},d(s){s&&b(t)}}}function ka(n){let t,l=n[24]&&Os(n);return{c(){l&&l.c(),t=_e()},l(e){l&&l.l(e),t=_e()},m(e,s){l&&l.m(e,s),O(e,t,s)},p(e,s){e[24]?l?l.p(e,s):(l=Os(e),l.c(),l.m(t.parentNode,t)):l&&(l.d(1),l=null)},d(e){e&&b(t),l&&l.d(e)}}}function Ea(n){let t;const l=n[50]["atom-label"],e=Fe(l,n,n[96],gs),s=e||ka(n);return{c(){s&&s.c()},l(i){s&&s.l(i)},m(i,r){s&&s.m(i,r),t=!0},p(i,r){e?e.p&&(!t||r[3]&8)&&Ze(e,l,i,i[96],t?Ge(l,i[96],r,aa):We(i[96]),gs):s&&s.p&&(!t||r[0]&16777216|r[1]&128|r[3]&32)&&s.p(i,t?r:[-1,-1,-1,-1])},i(i){t||(p(s,i),t=!0)},o(i){S(s,i),t=!1},d(i){s&&s.d(i)}}}function Ta(n){let t,l,e,s;const i=[{structure:n[28]?Sl(n[4]):n[4]},{show_atoms:n[12]},{show_bonds:n[13]},{show_cell:n[15]},{show_vectors:n[19]},n[47],{cell_opacity:n[16]},{cell_line_width:n[33]},{bond_radius:n[14]},{camera_position:n[32]},{auto_rotate:n[7]},{pan_speed:n[10]},{zoom_speed:n[9]},{bond_color_mode:n[26]},{bond_color:n[27]},{bonding_strategy:n[25]},{rotation_damping:n[8]},{directional_light:n[29]},{ambient_light:n[30]}];function r(f){n[88](f)}function o(f){n[89](f)}let a={$$slots:{"atom-label":[Ea,({elem:f})=>({98:f}),({elem:f})=>[0,0,0,f?32:0]]},$$scope:{ctx:n}};for(let f=0;f<i.length;f+=1)a=Xe(a,i[f]);return n[5]!==void 0&&(a.atom_radius=n[5]),n[6]!==void 0&&(a.same_size_atoms=n[6]),t=new ia({props:a}),$e.push(()=>An(t,"atom_radius",r)),$e.push(()=>An(t,"same_size_atoms",o)),{c(){$(t.$$.fragment)},l(f){ee(t.$$.fragment,f)},m(f,c){te(t,f,c),s=!0},p(f,c){const u=c[0]&2114582416|c[1]&65542?Jt(i,[c[0]&268435472&&{structure:f[28]?Sl(f[4]):f[4]},c[0]&4096&&{show_atoms:f[12]},c[0]&8192&&{show_bonds:f[13]},c[0]&32768&&{show_cell:f[15]},c[0]&524288&&{show_vectors:f[19]},c[1]&65536&&cn(f[47]),c[0]&65536&&{cell_opacity:f[16]},c[1]&4&&{cell_line_width:f[33]},c[0]&16384&&{bond_radius:f[14]},c[1]&2&&{camera_position:f[32]},c[0]&128&&{auto_rotate:f[7]},c[0]&1024&&{pan_speed:f[10]},c[0]&512&&{zoom_speed:f[9]},c[0]&67108864&&{bond_color_mode:f[26]},c[0]&134217728&&{bond_color:f[27]},c[0]&33554432&&{bonding_strategy:f[25]},c[0]&256&&{rotation_damping:f[8]},c[0]&536870912&&{directional_light:f[29]},c[0]&1073741824&&{ambient_light:f[30]}]):{};c[0]&16777216|c[1]&128|c[3]&40&&(u.$$scope={dirty:c,ctx:f}),!l&&c[0]&32&&(l=!0,u.atom_radius=f[5],zn(()=>l=!1)),!e&&c[0]&64&&(e=!0,u.same_size_atoms=f[6],zn(()=>e=!1)),t.$set(u)},i(f){s||(p(t.$$.fragment,f),s=!0)},o(f){S(t.$$.fragment,f),s=!1},d(f){ne(t,f)}}}function wa(n){let t,l,e,s,i,r;const o=[_a,ma,ua],a=[];function f(c,u){var m;return(m=c[4])!=null&&m.sites?0:c[4]?1:2}return t=f(n),l=a[t]=o[t](n),{c(){l.c(),e=_e()},l(c){l.l(c),e=_e()},m(c,u){a[t].m(c,u),O(c,e,u),s=!0,i||(r=[X(window,"keydown",n[42]),X(window,"click",function(){sl(n[43]([n[17],n[18]],n[51]))&&n[43]([n[17],n[18]],n[51]).apply(this,arguments)})],i=!0)},p(c,u){n=c;let m=t;t=f(n),t===m?a[t].p(n,u):(we(),S(a[m],1,1,()=>{a[m]=null}),Se(),l=a[t],l?l.p(n,u):(l=a[t]=o[t](n),l.c()),p(l,1),l.m(e.parentNode,e))},i(c){s||(p(l),s=!0)},o(c){S(l),s=!1},d(c){c&&b(e),a[t].d(c),i=!1,qt(r)}}}function Sa(n,t,l){var qe,Ie;let e;const s=["structure","atom_radius","same_size_atoms","camera_position","auto_rotate","rotation_damping","zoom_speed","pan_speed","controls_open","background_color","reveal_buttons","fullscreen","show_atoms","show_bonds","bond_radius","show_cell","cell_opacity","cell_line_width","wrapper","controls","toggle_controls_btn","show_vectors","width","height","color_scheme","hovered","dragover","allow_file_drop","tips_modal","enable_tips","save_json_btn_text","save_png_btn_text","show_site_labels","atom_labels_style","bonding_strategy","bond_color_mode","bond_color","style","show_image_atoms","directional_light","ambient_light","show_full_controls","toggle_fullscreen"];let i=Ct(t,s),r;Qe(n,ln,E=>l(97,r=E));let{$$slots:o={},$$scope:a}=t,{structure:f=void 0}=t,{atom_radius:c=.5}=t,{same_size_atoms:u=!0}=t,{camera_position:m=[10,5,2*(((qe=f==null?void 0:f.lattice)==null?void 0:qe.c)??5)]}=t,{auto_rotate:_=0}=t,{rotation_damping:g=.1}=t,{zoom_speed:T=.3}=t,{pan_speed:k=1}=t,{controls_open:w=!1}=t,{background_color:j="#0000ff"}=t,{reveal_buttons:z=500}=t,{fullscreen:B=!1}=t,{show_atoms:I=!0}=t,{show_bonds:H=!0}=t,{bond_radius:Y=void 0}=t,{show_cell:v="wireframe"}=t,{cell_opacity:L=v=="surface"?.2:.4}=t,{cell_line_width:Q=1}=t,{wrapper:N=void 0}=t,{controls:re=void 0}=t,{toggle_controls_btn:se=void 0}=t,{show_vectors:U=!0}=t,{width:Z=0}=t,{height:ie=0}=t,{color_scheme:be="Vesta"}=t,{hovered:ce=!1}=t,{dragover:fe=!1}=t,{allow_file_drop:Le=!0}=t,{tips_modal:de=void 0}=t,{enable_tips:Pe=!0}=t,{save_json_btn_text:ue="⬇ Save as JSON"}=t,{save_png_btn_text:ge="✎ Save as PNG"}=t,{show_site_labels:A=(((Ie=f==null?void 0:f.sites)==null?void 0:Ie.length)??0)<20}=t,{atom_labels_style:ye=null}=t,{bonding_strategy:K="nearest_neighbor"}=t,{bond_color_mode:G="single"}=t,{bond_color:Me="#ffffff"}=t,{style:Ne=null}=t,{show_image_atoms:Oe=!0}=t,{directional_light:le=2}=t,{ambient_light:ze=1.2}=t,{show_full_controls:Ae=!1}=t;function Mt(E){E.key==="Escape"&&l(11,w=!1)}const dt=(E,Ee)=>Yt=>{!E||!Yt.target||E&&E.some(Ye=>Ye==null?void 0:Ye.contains(Yt.target))||Ee()};function Ut(){f||alert("No structure to download");const E=JSON.stringify(f,null,2),Ee=f!=null&&f.id?`${f==null?void 0:f.id} (${Tl(f)}).json`:`${Tl(f)}.json`;Cl(E,Ee,"application/json")}function At(E){var Ye;if(l(22,fe=!1),!Le)return;const Ee=(Ye=E.dataTransfer)==null?void 0:Ye.items[0].getAsFile(),Yt=new FileReader;Yt.onloadend=R=>{try{l(4,f=JSON.parse(R.target.result))}catch(W){console.error("Invalid JSON file",W)}},Yt.readAsText(Ee)}function Ke(){const E=N==null?void 0:N.querySelector("canvas");E==null||E.toBlob(Ee=>{Cl(Ee,"scene.png","image/png")})}function It(){!document.fullscreenElement&&N?N.requestFullscreen().catch(console.error):document.exitFullscreen()}const Re=()=>{w&&l(11,w=!1)},Lt=()=>de==null?void 0:de.showModal(),ht=()=>l(11,w=!w);function it(E){$e[E?"unshift":"push"](()=>{se=E,l(18,se)})}function Bt(E){de=E,l(23,de)}function Et(){I=this.checked,l(12,I)}function Ht(){H=this.checked,l(13,H)}function C(){U=this.checked,l(19,U)}function pe(){Oe=this.checked,l(28,Oe)}function Nt(){Ae=this.checked,l(31,Ae)}function gt(){A=this.checked,l(24,A)}function ot(){v=Sn(this),l(15,v)}function at(){c=ve(this.value),l(5,c)}function Rt(){c=ve(this.value),l(5,c)}function rt(){u=this.checked,l(6,u)}function d(){L=ve(this.value),l(16,L)}function F(){L=ve(this.value),l(16,L)}function J(){K=Sn(this),l(25,K)}function me(){G=Sn(this),l(26,G)}function he(){Me=this.value,l(27,Me)}function bt(){Y=ve(this.value),l(14,Y)}function ke(){Y=ve(this.value),l(14,Y)}function vt(){j=this.value,l(0,j)}function Zt(){_=ve(this.value),l(7,_)}function Wt(){_=ve(this.value),l(7,_)}function je(){T=ve(this.value),l(9,T)}function et(){T=ve(this.value),l(9,T)}function Kt(){k=ve(this.value),l(10,k)}function tt(){k=ve(this.value),l(10,k)}function zt(){le=ve(this.value),l(29,le)}function yt(){le=ve(this.value),l(29,le)}function vn(){ze=ve(this.value),l(30,ze)}function De(){ze=ve(this.value),l(30,ze)}function fn(){g=ve(this.value),l(8,g)}function yn(){g=ve(this.value),l(8,g)}function Ve(){be=Sn(this),l(3,be)}function un(E){$e[E?"unshift":"push"](()=>{re=E,l(17,re)})}function $t(E){c=E,l(5,c)}function Tt(E){u=E,l(6,u)}function mn(E){$e[E?"unshift":"push"](()=>{N=E,l(1,N)})}function en(){Z=this.clientWidth,ie=this.clientHeight,l(2,Z),l(20,ie)}const ct=()=>l(21,ce=!0),Un=()=>l(21,ce=!1),kn=()=>Le&&l(22,fe=!0),Je=()=>Le&&l(22,fe=!1);return n.$$set=E=>{t=Xe(Xe({},t),rn(E)),l(47,i=Ct(t,s)),"structure"in E&&l(4,f=E.structure),"atom_radius"in E&&l(5,c=E.atom_radius),"same_size_atoms"in E&&l(6,u=E.same_size_atoms),"camera_position"in E&&l(32,m=E.camera_position),"auto_rotate"in E&&l(7,_=E.auto_rotate),"rotation_damping"in E&&l(8,g=E.rotation_damping),"zoom_speed"in E&&l(9,T=E.zoom_speed),"pan_speed"in E&&l(10,k=E.pan_speed),"controls_open"in E&&l(11,w=E.controls_open),"background_color"in E&&l(0,j=E.background_color),"reveal_buttons"in E&&l(48,z=E.reveal_buttons),"fullscreen"in E&&l(49,B=E.fullscreen),"show_atoms"in E&&l(12,I=E.show_atoms),"show_bonds"in E&&l(13,H=E.show_bonds),"bond_radius"in E&&l(14,Y=E.bond_radius),"show_cell"in E&&l(15,v=E.show_cell),"cell_opacity"in E&&l(16,L=E.cell_opacity),"cell_line_width"in E&&l(33,Q=E.cell_line_width),"wrapper"in E&&l(1,N=E.wrapper),"controls"in E&&l(17,re=E.controls),"toggle_controls_btn"in E&&l(18,se=E.toggle_controls_btn),"show_vectors"in E&&l(19,U=E.show_vectors),"width"in E&&l(2,Z=E.width),"height"in E&&l(20,ie=E.height),"color_scheme"in E&&l(3,be=E.color_scheme),"hovered"in E&&l(21,ce=E.hovered),"dragover"in E&&l(22,fe=E.dragover),"allow_file_drop"in E&&l(34,Le=E.allow_file_drop),"tips_modal"in E&&l(23,de=E.tips_modal),"enable_tips"in E&&l(35,Pe=E.enable_tips),"save_json_btn_text"in E&&l(36,ue=E.save_json_btn_text),"save_png_btn_text"in E&&l(37,ge=E.save_png_btn_text),"show_site_labels"in E&&l(24,A=E.show_site_labels),"atom_labels_style"in E&&l(38,ye=E.atom_labels_style),"bonding_strategy"in E&&l(25,K=E.bonding_strategy),"bond_color_mode"in E&&l(26,G=E.bond_color_mode),"bond_color"in E&&l(27,Me=E.bond_color),"style"in E&&l(39,Ne=E.style),"show_image_atoms"in E&&l(28,Oe=E.show_image_atoms),"directional_light"in E&&l(29,le=E.directional_light),"ambient_light"in E&&l(30,ze=E.ambient_light),"show_full_controls"in E&&l(31,Ae=E.show_full_controls),"$$scope"in E&&l(96,a=E.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&8&&Is(ln,r=al[be],r),n.$$.dirty[0]&4|n.$$.dirty[1]&131072&&l(41,e=z==!0||typeof z=="number"&&z<Z),n.$$.dirty[0]&3|n.$$.dirty[1]&262144&&(document.documentElement.style.setProperty("--struct-bg",`${j}20`),B&&!document.fullscreenElement&&N?N.requestFullscreen().catch(console.error):!B&&document.fullscreenElement&&document.exitFullscreen())},[j,N,Z,be,f,c,u,_,g,T,k,w,I,H,Y,v,L,re,se,U,ie,ce,fe,de,A,K,G,Me,Oe,le,ze,Ae,m,Q,Le,Pe,ue,ge,ye,Ne,It,e,Mt,dt,Ut,At,Ke,i,z,B,o,Re,Lt,ht,it,Bt,Et,Ht,C,pe,Nt,gt,ot,at,Rt,rt,d,F,J,me,he,bt,ke,vt,Zt,Wt,je,et,Kt,tt,zt,yt,vn,De,fn,yn,Ve,un,$t,Tt,mn,en,ct,Un,kn,Je,a]}class Va extends Ot{constructor(t){super(),Pt(this,t,Sa,wa,st,{structure:4,atom_radius:5,same_size_atoms:6,camera_position:32,auto_rotate:7,rotation_damping:8,zoom_speed:9,pan_speed:10,controls_open:11,background_color:0,reveal_buttons:48,fullscreen:49,show_atoms:12,show_bonds:13,bond_radius:14,show_cell:15,cell_opacity:16,cell_line_width:33,wrapper:1,controls:17,toggle_controls_btn:18,show_vectors:19,width:2,height:20,color_scheme:3,hovered:21,dragover:22,allow_file_drop:34,tips_modal:23,enable_tips:35,save_json_btn_text:36,save_png_btn_text:37,show_site_labels:24,atom_labels_style:38,bonding_strategy:25,bond_color_mode:26,bond_color:27,style:39,show_image_atoms:28,directional_light:29,ambient_light:30,show_full_controls:31,toggle_fullscreen:40},null,[-1,-1,-1,-1])}get toggle_fullscreen(){return this.$$.ctx[40]}}export{Va as S};
